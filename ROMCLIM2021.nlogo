extensions [gis]
globals [
  Capitales Capitales-labels Villae_viticoles Dioceses Limite_olivier Hydrography Narbonnaise Olivier_area_Leveau Villae_Turci

  GR_2500 GR_2400 GR_2300 GR_2200 GR_2100 GR_2000 GR_1900 GR_1800 GR_1700 GR_1600 GR_1500 GR_1400 GR_1300 ; Grapes rainfed by LPJmL true

  OR_2500 OR_2400 OR_2300 OR_2200 OR_2100 OR_2000 OR_1900 OR_1800 OR_1700 OR_1600 OR_1500 OR_1400 OR_1300 ; Olives rainfed by LPJmL true

  P1_2500 P2_2500 P3_2500 P4_2500 P5_2500 P6_2500 P7_2500 P8_2500 P9_2500 P10_2500 P11_2500 P12_2500 ;2500 BP
  T1_2500 T2_2500 T3_2500 T4_2500 T5_2500 T6_2500 T7_2500 T8_2500 T9_2500 T10_2500 T11_2500 T12_2500

  P1_2400 P2_2400 P3_2400 P4_2400 P5_2400 P6_2400 P7_2400 P8_2400 P9_2400 P10_2400 P11_2400 P12_2400 ;2400 BP
  T1_2400 T2_2400 T3_2400 T4_2400 T5_2400 T6_2400 T7_2400 T8_2400 T9_2400 T10_2400 T11_2400 T12_2400

  P1_2300 P2_2300 P3_2300 P4_2300 P5_2300 P6_2300 P7_2300 P8_2300 P9_2300 P10_2300 P11_2300 P12_2300 ;2300 BP
  T1_2300 T2_2300 T3_2300 T4_2300 T5_2300 T6_2300 T7_2300 T8_2300 T9_2300 T10_2300 T11_2300 T12_2300

  P1_2200 P2_2200 P3_2200 P4_2200 P5_2200 P6_2200 P7_2200 P8_2200 P9_2200 P10_2200 P11_2200 P12_2200 ;2200 BP
  T1_2200 T2_2200 T3_2200 T4_2200 T5_2200 T6_2200 T7_2200 T8_2200 T9_2200 T10_2200 T11_2200 T12_2200

  P1_2100 P2_2100 P3_2100 P4_2100 P5_2100 P6_2100 P7_2100 P8_2100 P9_2100 P10_2100 P11_2100 P12_2100 ;2100 BP
  T1_2100 T2_2100 T3_2100 T4_2100 T5_2100 T6_2100 T7_2100 T8_2100 T9_2100 T10_2100 T11_2100 T12_2100

  P1_2000 P2_2000 P3_2000 P4_2000 P5_2000 P6_2000 P7_2000 P8_2000 P9_2000 P10_2000 P11_2000 P12_2000 ;2000 BP
  T1_2000 T2_2000 T3_2000 T4_2000 T5_2000 T6_2000 T7_2000 T8_2000 T9_2000 T10_2000 T11_2000 T12_2000

  P1_1900 P2_1900 P3_1900 P4_1900 P5_1900 P6_1900 P7_1900 P8_1900 P9_1900 P10_1900 P11_1900 P12_1900 ;1900 BP
  T1_1900 T2_1900 T3_1900 T4_1900 T5_1900 T6_1900 T7_1900 T8_1900 T9_1900 T10_1900 T11_1900 T12_1900

  P1_1800 P2_1800 P3_1800 P4_1800 P5_1800 P6_1800 P7_1800 P8_1800 P9_1800 P10_1800 P11_1800 P12_1800 ;1800 BP
  T1_1800 T2_1800 T3_1800 T4_1800 T5_1800 T6_1800 T7_1800 T8_1800 T9_1800 T10_1800 T11_1800 T12_1800

  P1_1700 P2_1700 P3_1700 P4_1700 P5_1700 P6_1700 P7_1700 P8_1700 P9_1700 P10_1700 P11_1700 P12_1700 ;1700 BP
  T1_1700 T2_1700 T3_1700 T4_1700 T5_1700 T6_1700 T7_1700 T8_1700 T9_1700 T10_1700 T11_1700 T12_1700

  P1_1600 P2_1600 P3_1600 P4_1600 P5_1600 P6_1600 P7_1600 P8_1600 P9_1600 P10_1600 P11_1600 P12_1600 ;1600 BP
  T1_1600 T2_1600 T3_1600 T4_1600 T5_1600 T6_1600 T7_1600 T8_1600 T9_1600 T10_1600 T11_1600 T12_1600

  P1_1500 P2_1500 P3_1500 P4_1500 P5_1500 P6_1500 P7_1500 P8_1500 P9_1500 P10_1500 P11_1500 P12_1500 ;1500 BP
  T1_1500 T2_1500 T3_1500 T4_1500 T5_1500 T6_1500 T7_1500 T8_1500 T9_1500 T10_1500 T11_1500 T12_1500

  P1_1400 P2_1400 P3_1400 P4_1400 P5_1400 P6_1400 P7_1400 P8_1400 P9_1400 P10_1400 P11_1400 P12_1400 ;1400 BP
  T1_1400 T2_1400 T3_1400 T4_1400 T5_1400 T6_1400 T7_1400 T8_1400 T9_1400 T10_1400 T11_1400 T12_1400

  P1_1300 P2_1300 P3_1300 P4_1300 P5_1300 P6_1300 P7_1300 P8_1300 P9_1300 P10_1300 P11_1300 P12_1300 ;1300 BP
  T1_1300 T2_1300 T3_1300 T4_1300 T5_1300 T6_1300 T7_1300 T8_1300 T9_1300 T10_1300 T11_1300 T12_1300

  P1_REF P2_REF P3_REF P4_REF P5_REF P6_REF P7_REF P8_REF P9_REF P10_REF P11_REF P12_REF
  T1_REF T2_REF T3_REF T4_REF T5_REF T6_REF T7_REF T8_REF T9_REF T10_REF T11_REF T12_REF

  WheatR_2500_LPJmL Archeo_Olive Archaeo_Wine
]
breed [Towns Town]
Towns-own [local_carrying_capacity]
breed [Farms Farm]
Farms-own [cultivated-area People Harvest Surplus Surplus_Price Seed Distance_to_towns Distance_cost]
breed [wineries winerie]
Wineries-own [area_exploited Production Distance_to_towns Distance_cost Price_production Benefit Number_of_Slaves Slaves_cost]
breed [Olives_groves Olive_grove]
Olives_groves-own [area_exploited production Price_production Distance_to_towns Distance_cost Benefit Number_of_Slaves Slaves_cost ]

patches-own [
  P1_2500BP P2_2500BP P3_2500BP P4_2500BP P5_2500BP P6_2500BP P7_2500BP P8_2500BP P9_2500BP P10_2500BP P11_2500BP P12_2500BP
  T1_2500BP T2_2500BP T3_2500BP T4_2500BP T5_2500BP T6_2500BP T7_2500BP T8_2500BP T9_2500BP T10_2500BP T11_2500BP T12_2500BP

  P1_2400BP P2_2400BP P3_2400BP P4_2400BP P5_2400BP P6_2400BP P7_2400BP P8_2400BP P9_2400BP P10_2400BP P11_2400BP P12_2400BP
  T1_2400BP T2_2400BP T3_2400BP T4_2400BP T5_2400BP T6_2400BP T7_2400BP T8_2400BP T9_2400BP T10_2400BP T11_2400BP T12_2400BP

  P1_2300BP P2_2300BP P3_2300BP P4_2300BP P5_2300BP P6_2300BP P7_2300BP P8_2300BP P9_2300BP P10_2300BP P11_2300BP P12_2300BP
  T1_2300BP T2_2300BP T3_2300BP T4_2300BP T5_2300BP T6_2300BP T7_2300BP T8_2300BP T9_2300BP T10_2300BP T11_2300BP T12_2300BP

  P1_2200BP P2_2200BP P3_2200BP P4_2200BP P5_2200BP P6_2200BP P7_2200BP P8_2200BP P9_2200BP P10_2200BP P11_2200BP P12_2200BP
  T1_2200BP T2_2200BP T3_2200BP T4_2200BP T5_2200BP T6_2200BP T7_2200BP T8_2200BP T9_2200BP T10_2200BP T11_2200BP T12_2200BP

  P1_2100BP P2_2100BP P3_2100BP P4_2100BP P5_2100BP P6_2100BP P7_2100BP P8_2100BP P9_2100BP P10_2100BP P11_2100BP P12_2100BP
  T1_2100BP T2_2100BP T3_2100BP T4_2100BP T5_2100BP T6_2100BP T7_2100BP T8_2100BP T9_2100BP T10_2100BP T11_2100BP T12_2100BP

  P1_2000BP P2_2000BP P3_2000BP P4_2000BP P5_2000BP P6_2000BP P7_2000BP P8_2000BP P9_2000BP P10_2000BP P11_2000BP P12_2000BP
  T1_2000BP T2_2000BP T3_2000BP T4_2000BP T5_2000BP T6_2000BP T7_2000BP T8_2000BP T9_2000BP T10_2000BP T11_2000BP T12_2000BP

  P1_1900BP P2_1900BP P3_1900BP P4_1900BP P5_1900BP P6_1900BP P7_1900BP P8_1900BP P9_1900BP P10_1900BP P11_1900BP P12_1900BP
  T1_1900BP T2_1900BP T3_1900BP T4_1900BP T5_1900BP T6_1900BP T7_1900BP T8_1900BP T9_1900BP T10_1900BP T11_1900BP T12_1900BP

  P1_1800BP P2_1800BP P3_1800BP P4_1800BP P5_1800BP P6_1800BP P7_1800BP P8_1800BP P9_1800BP P10_1800BP P11_1800BP P12_1800BP
  T1_1800BP T2_1800BP T3_1800BP T4_1800BP T5_1800BP T6_1800BP T7_1800BP T8_1800BP T9_1800BP T10_1800BP T11_1800BP T12_1800BP

  P1_1700BP P2_1700BP P3_1700BP P4_1700BP P5_1700BP P6_1700BP P7_1700BP P8_1700BP P9_1700BP P10_1700BP P11_1700BP P12_1700BP
  T1_1700BP T2_1700BP T3_1700BP T4_1700BP T5_1700BP T6_1700BP T7_1700BP T8_1700BP T9_1700BP T10_1700BP T11_1700BP T12_1700BP

  P1_1600BP P2_1600BP P3_1600BP P4_1600BP P5_1600BP P6_1600BP P7_1600BP P8_1600BP P9_1600BP P10_1600BP P11_1600BP P12_1600BP
  T1_1600BP T2_1600BP T3_1600BP T4_1600BP T5_1600BP T6_1600BP T7_1600BP T8_1600BP T9_1600BP T10_1600BP T11_1600BP T12_1600BP

  P1_1500BP P2_1500BP P3_1500BP P4_1500BP P5_1500BP P6_1500BP P7_1500BP P8_1500BP P9_1500BP P10_1500BP P11_1500BP P12_1500BP
  T1_1500BP T2_1500BP T3_1500BP T4_1500BP T5_1500BP T6_1500BP T7_1500BP T8_1500BP T9_1500BP T10_1500BP T11_1500BP T12_1500BP

  P1_1400BP P2_1400BP P3_1400BP P4_1400BP P5_1400BP P6_1400BP P7_1400BP P8_1400BP P9_1400BP P10_1400BP P11_1400BP P12_1400BP
  T1_1400BP T2_1400BP T3_1400BP T4_1400BP T5_1400BP T6_1400BP T7_1400BP T8_1400BP T9_1400BP T10_1400BP T11_1400BP T12_1400BP

  P1_1300BP P2_1300BP P3_1300BP P4_1300BP P5_1300BP P6_1300BP P7_1300BP P8_1300BP P9_1300BP P10_1300BP P11_1300BP P12_1300BP
  T1_1300BP T2_1300BP T3_1300BP T4_1300BP T5_1300BP T6_1300BP T7_1300BP T8_1300BP T9_1300BP T10_1300BP T11_1300BP T12_1300BP

  P1_REF_ P2_REF_ P3_REF_ P4_REF_ P5_REF_ P6_REF_ P7_REF_ P8_REF_ P9_REF_ P10_REF_ P11_REF_ P12_REF_
  T1_REF_ T2_REF_ T3_REF_ T4_REF_ T5_REF_ T6_REF_ T7_REF_ T8_REF_ T9_REF_ T10_REF_ T11_REF_ T12_REF_

  Thiv Tprt Tete Taut Phiv Pprt Pete Paut
  Thiv_var Tprt_var Tete_var Taut_var Phiv_var Pprt_var Pete_var Paut_var

  GR GI OR_ OI WR harvest_WR WI PR PI_ Prix_olive/ha Prix_vin/ha

  WheatR_2500BP_LPJmL

  GR_2500_ GR_2400_ GR_2300_ GR_2200_ GR_2100_ GR_2000_ GR_1900_ GR_1800_ GR_1700_ GR_1600_ GR_1500_ GR_1400_ GR_1300_

  OR_2500_ OR_2400_ OR_2300_ OR_2200_ OR_2100_ OR_2000_ OR_1900_ OR_1800_ OR_1700_ OR_1600_ OR_1500_ OR_1400_ OR_1300_

  Name
]

to setup
  ca
  reset-ticks
  resize-world 0 65 0 33
  gis:set-world-envelope [2.0833 7.583299779999999 42.1666678 45]
  set-current-directory "https://github.com/Bernigaud2021/ROMCLIM/tree/main/External_files"
  gis:load-coordinate-system "Shapefiles/4326.prj"
  set Capitales gis:load-dataset "Shapefiles/Chef_lieux_cite_.shp"; charge shapefile capitales de cités
  set Villae_viticoles gis:load-dataset "Shapefiles/Attestation_viticulture.shp"; charge shapefile villae viticoles
  set Dioceses gis:load-dataset "Shapefiles/diocese_boundaries_EPSG4326.shp"; charge shapefile limites de cités
  set Archeo_Olive gis:load-dataset "Shapefiles/sites_oleicoles_Var_Brun.shp"; shapefile des sites oleicoles reconnus par l'archéologie
  set Archaeo_Wine gis:load-dataset "Shapefiles/Attestation_viticulture.shp"; shapefile des attestations archéologique de la culture de la vigne
  set Limite_olivier gis:load-dataset "Shapefiles/Olive_area.shp"; shapefile de la limite supérieure de l'olivier
  set Olivier_area_Leveau gis:load-dataset  "Shapefiles/Oleiculture_archeologie_leveau_2003.shp"; shapefile de la limite supérieure de l'olivier
  ;gis:draw Limite_olivier 2
  ;gis:draw Olivier_area_Leveau 2
  set Narbonnaise gis:load-dataset "Shapefiles/Narbonnaise2.shp"
  ;set Villae_Turci gis:load-dataset "C:/Users/Bernigaud Nicolas/Desktop/Workshop_RDMed_2021/Shapefiles/Villae_Turci_2021_.shp"
  ;gis:draw Villae_Turci 1
  ;gis:draw Narbonnaise 1
  ;gis:draw Dioceses 1
  ;set Hydrography gis:load-dataset "C:/Users/Bernigaud Nicolas/Dropbox/Bouby_Séminaire_27_avril/european_rivers/Europe_Hydrography.shp"
  ;gis:draw Hydrography 2
  gis:apply-coverage Dioceses "NAME" Name
  ;ask patches [set plabel Name]
  ;ask patches gis:intersecting Villae_viticoles [sprout-Farms 1]
  import-Grapes-LPJmL
  apply-Grapes-LPJmL
  import-Olives-LPJmL
  apply-Olives-LPJmL
  import-climatic-data
  apply-climatic-data
  import-2500BP-LPJmL-data
  ;apply-2500BP-LPJmL-data
  compute-climatic-data
  ;if Century = "2500 BP" [compute-climatic-data-2500BP]
  ;if Century = "2000 BP" [compute-climatic-data-2000BP]
  ;if Century = "Actual" [compute-climatic-data-REF]
  create_var
  emulate-LPJmL_var
  ;gis:paint P1_2500 50
  ;ask Towns [set size local_carrying_capacity / 1000000]
  setup-Towns
  ;display-Dioceses
  if Dis-archeo-olives? = TRUE [display-Archeo-Olives]
  if Dis-archeo-wine? = TRUE [display-Archeo-Wine]
  ;if Culture = "Wheat rainfed" [
    ;setup-Farms-R
    ;ask Farms [if harvest < people * 0.3 [die]]
  ;]
  ;if Culture = "Wheat irrigated" [
    ;setup-Farms-I
    ;ask Farms [if harvest < people * 0.3 [die]]
  ;]
  ;ask Farms [if harvest < people * 0.3 [die]]
  ;if Culture = "Grapes irrigated" [setup-Wineries-I]
  ;if Culture = "Grapes rainfed" [setup-Wineries-R]
  ;if Culture = "Olives rainfed" [setup-Olives_groves-R setup-Wineries-R2]
  if Culture = "None" [setup-Olives_groves-R setup-Wineries-R2 setup-Farms-R setup-Towns]
  setup-Towns
  color-patches
  ;foreach gis:feature-list-of Capitales [set Capitales-labels [gis:property-value "Commune"]]
;color-patches2
end

to go
  ask patches [
  ;set pcolor scale-color green OlR_t/ha 0 1.5

  ;set prix_olive/ha OR_ * 1000 * 8; convertit le rendement en t/ha en kl/ha (x 1000) que multiplie le prix d'un sextarius d'olive d'après l'édit de Dioclétion (4 deniers/HS le sextarius = 8 deniers/HS le litre)
  set prix_vin/ha GI * 100 * 16; 8 deniers au prix le plus bas pour le sextarius de vin italique
    ;if OlR_t/ha > mean [OlR_t/ha] of patches []]
  ]
  create_var
  ;ask patches [set WR 0]
  compute-climatic-data
  emulate-LPJML_var
  color-patches
  ;ask Towns [ask patches in-radius 3 [if OlR_t/ha > mean [OlR_t/ha] of patches [sprout-Olives_groves 1]]]
  ;ask patches [if OlR_t/ha < mean [OlR_t/ha] of patches [ask Olives_groves [die]]]
  ;tick
  ;ask Olives_groves [die]
  ;ask Towns [set size local_carrying_capacity / 1000000]
  if Culture = "Wheat rainfed" [
    ask Farms [die]
    setup-Farms-R
    ask Farms [if harvest < people * 0.3 [die]]; les fermes meurent si la quantité de blé pour la nourriture des exploitants n'est pas produite dans l'année (0.3 tonnes par habitants/par an)
  ]
   if Culture = "Wheat irrigated" [
    ask Farms [die]
    setup-Farms-I
    ask Farms [if harvest < people * 0.3 [die]]; les fermes meurent si la quantité de blé pour la nourriture des exploitants n'est pas produite dans l'année (0.3 tonnes par habitants/par an)
  ]
  if Culture = "Grapes rainfed" [
     ask Wineries [die]
     setup-Wineries-R
    ask Wineries [if GI < 5 [die]]; si les rendements sont en-dessous de 5 hl/ha les exploitations disparaissent.
    ]
  if Culture = "Grapes irrigated" [
    ask Wineries [die]
    setup-Wineries-I
    ask Wineries [if GI < 20 [die]]; si les rendements sont en-dessous de 20 hl/ha les exploitations disparaissent.
  ]
   if Culture = "Olives rainfed" [
    ask Olives_groves [die]
    setup-Olives_groves-R
    ask Olives_groves [if OR_ < 0.2 [die]]; si les rendements sont en-dessous de 0.2 t/ha les olivettes disparaissent.
  ]
   if Culture = "None" [
    ask Olives_groves [die]
    setup-Olives_groves-R
    ask Olives_groves [if Benefit < 0 [die]]; si les bénéfices sont négatifs, l'exploitation disparaît
    ask Wineries [die]
    setup-Wineries-R2
    ask Wineries [if Benefit < 0 [die]]; si les bénéfices sont négatifs, l'exploitation disparaît
    ask Farms [die]
    setup-Farms-R
    ask Farms [if Surplus_price < 0 [die]]; si les bénéfices sont négatifs, l'exploitation disparaît
  ]
  setup-Towns
  tick
end

to import-2500BP-climatic-data
  set-current-directory "https://github.com/Bernigaud2021/ROMCLIM/tree/main/External_files"
  set P1_2500 gis:load-dataset "Climatic_data/PRECIP/Precip_2500BP_1.asc"; importation des précip. mensuelles de 2500 BP
  set P2_2500 gis:load-dataset "Climatic_data/PRECIP/Precip_2500BP_2.asc"
  set P3_2500 gis:load-dataset "Climatic_data/PRECIP/Precip_2500BP_3.asc"
  set P4_2500 gis:load-dataset "Climatic_data/PRECIP/Precip_2500BP_4.asc"
  set P5_2500 gis:load-dataset "Climatic_data/PRECIP/Precip_2500BP_5.asc"
  set P6_2500 gis:load-dataset "Climatic_data/PRECIP/Precip_2500BP_6.asc"
  set P7_2500 gis:load-dataset "Climatic_data/PRECIP/Precip_2500BP_7.asc"
  set P8_2500 gis:load-dataset "Climatic_data/PRECIP/Precip_2500BP_8.asc"
  set P9_2500 gis:load-dataset "Climatic_data/PRECIP/Precip_2500BP_9.asc"
  set P10_2500 gis:load-dataset "Climatic_data/PRECIP/Precip_2500BP_10.asc"
  set P11_2500 gis:load-dataset "Climatic_data/PRECIP/Precip_2500BP_11.asc"
  set P12_2500 gis:load-dataset "Climatic_data/PRECIP/Precip_2500BP_12.asc"

  set T1_2500 gis:load-dataset "Climatic_data/TEMP/Temp_2500BP_1.asc"; importation des temp. mensuelles de 2500 BP
  set T2_2500 gis:load-dataset "Climatic_data/TEMP/Temp_2500BP_2.asc"
  set T3_2500 gis:load-dataset "Climatic_data/TEMP/Temp_2500BP_3.asc"
  set T4_2500 gis:load-dataset "Climatic_data/TEMP/Temp_2500BP_4.asc"
  set T5_2500 gis:load-dataset "Climatic_data/TEMP/Temp_2500BP_5.asc"
  set T6_2500 gis:load-dataset "Climatic_data/TEMP/Temp_2500BP_6.asc"
  set T7_2500 gis:load-dataset "Climatic_data/TEMP/Temp_2500BP_7.asc"
  set T8_2500 gis:load-dataset "Climatic_data/TEMP/Temp_2500BP_8.asc"
  set T9_2500 gis:load-dataset "Climatic_data/TEMP/Temp_2500BP_9.asc"
  set T10_2500 gis:load-dataset "Climatic_data/TEMP/Temp_2500BP_10.asc"
  set T11_2500 gis:load-dataset "Climatic_data/TEMP/Temp_2500BP_12.asc"
  set T12_2500 gis:load-dataset "Climatic_data/TEMP/Temp_2500BP_12.asc"
end

to import-2400BP-climatic-data
  set-current-directory "C:/Users/Bernigaud Nicolas/Dropbox/RDMed_postdoc/Article_RDMed_2021/Soumission_PNAS/ROMCLIM_data/External_files"
  set P1_2400 gis:load-dataset "Climatic_data/PRECIP/Precip_2400BP_1.asc"; importation des précip. mensuelles de 2400 BP
  set P2_2400 gis:load-dataset "Climatic_data/PRECIP/Precip_2400BP_2.asc"
  set P3_2400 gis:load-dataset "Climatic_data/PRECIP/Precip_2400BP_3.asc"
  set P4_2400 gis:load-dataset "Climatic_data/PRECIP/Precip_2400BP_4.asc"
  set P5_2400 gis:load-dataset "Climatic_data/PRECIP/Precip_2400BP_5.asc"
  set P6_2400 gis:load-dataset "Climatic_data/PRECIP/Precip_2400BP_6.asc"
  set P7_2400 gis:load-dataset "Climatic_data/PRECIP/Precip_2400BP_7.asc"
  set P8_2400 gis:load-dataset "Climatic_data/PRECIP/Precip_2400BP_8.asc"
  set P9_2400 gis:load-dataset "Climatic_data/PRECIP/Precip_2400BP_9.asc"
  set P10_2400 gis:load-dataset "Climatic_data/PRECIP/Precip_2400BP_10.asc"
  set P11_2400 gis:load-dataset "Climatic_data/PRECIP/Precip_2400BP_11.asc"
  set P12_2400 gis:load-dataset "Climatic_data/PRECIP/Precip_2400BP_12.asc"

  set T1_2400 gis:load-dataset "Climatic_data/TEMP/Temp_2400BP_1.asc"; importation des temp. mensuelles de 2400 BP
  set T2_2400 gis:load-dataset "Climatic_data/TEMP/Temp_2400BP_2.asc"
  set T3_2400 gis:load-dataset "Climatic_data/TEMP/Temp_2400BP_3.asc"
  set T4_2400 gis:load-dataset "Climatic_data/TEMP/Temp_2400BP_4.asc"
  set T5_2400 gis:load-dataset "Climatic_data/TEMP/Temp_2400BP_5.asc"
  set T6_2400 gis:load-dataset "Climatic_data/TEMP/Temp_2400BP_6.asc"
  set T7_2400 gis:load-dataset "Climatic_data/TEMP/Temp_2400BP_7.asc"
  set T8_2400 gis:load-dataset "Climatic_data/TEMP/Temp_2400BP_8.asc"
  set T9_2400 gis:load-dataset "Climatic_data/TEMP/Temp_2400BP_9.asc"
  set T10_2400 gis:load-dataset "Climatic_data/TEMP/Temp_2400BP_10.asc"
  set T11_2400 gis:load-dataset "Climatic_data/TEMP/Temp_2400BP_12.asc"
  set T12_2400 gis:load-dataset "Climatic_data/TEMP/Temp_2400BP_12.asc"
end

to import-2300BP-climatic-data
  set-current-directory "C:/Users/Bernigaud Nicolas/Dropbox/RDMed_postdoc/Article_RDMed_2021/Soumission_PNAS/ROMCLIM_data/External_files"
  set P1_2300 gis:load-dataset "Climatic_data/PRECIP/Precip_2300BP_1.asc"; importation des précip. mensuelles de 2300 BP
  set P2_2300 gis:load-dataset "Climatic_data/PRECIP/Precip_2300BP_2.asc"
  set P3_2300 gis:load-dataset "Climatic_data/PRECIP/Precip_2300BP_3.asc"
  set P4_2300 gis:load-dataset "Climatic_data/PRECIP/Precip_2300BP_4.asc"
  set P5_2300 gis:load-dataset "Climatic_data/PRECIP/Precip_2300BP_5.asc"
  set P6_2300 gis:load-dataset "Climatic_data/PRECIP/Precip_2300BP_6.asc"
  set P7_2300 gis:load-dataset "Climatic_data/PRECIP/Precip_2300BP_7.asc"
  set P8_2300 gis:load-dataset "Climatic_data/PRECIP/Precip_2300BP_8.asc"
  set P9_2300 gis:load-dataset "Climatic_data/PRECIP/Precip_2300BP_9.asc"
  set P10_2300 gis:load-dataset "Climatic_data/PRECIP/Precip_2300BP_10.asc"
  set P11_2300 gis:load-dataset "Climatic_data/PRECIP/Precip_2300BP_11.asc"
  set P12_2300 gis:load-dataset "Climatic_data/PRECIP/Precip_2300BP_12.asc"

  set T1_2300 gis:load-dataset "Climatic_data/TEMP/Temp_2300BP_1.asc"; importation des temp. mensuelles de 2300 BP
  set T2_2300 gis:load-dataset "Climatic_data/TEMP/Temp_2300BP_2.asc"
  set T3_2300 gis:load-dataset "Climatic_data/TEMP/Temp_2300BP_3.asc"
  set T4_2300 gis:load-dataset "Climatic_data/TEMP/Temp_2300BP_4.asc"
  set T5_2300 gis:load-dataset "Climatic_data/TEMP/Temp_2300BP_5.asc"
  set T6_2300 gis:load-dataset "Climatic_data/TEMP/Temp_2300BP_6.asc"
  set T7_2300 gis:load-dataset "Climatic_data/TEMP/Temp_2300BP_7.asc"
  set T8_2300 gis:load-dataset "Climatic_data/TEMP/Temp_2300BP_8.asc"
  set T9_2300 gis:load-dataset "Climatic_data/TEMP/Temp_2300BP_9.asc"
  set T10_2300 gis:load-dataset "Climatic_data/TEMP/Temp_2300BP_10.asc"
  set T11_2300 gis:load-dataset "Climatic_data/TEMP/Temp_2300BP_12.asc"
  set T12_2300 gis:load-dataset "Climatic_data/TEMP/Temp_2300BP_12.asc"
end

to import-2200BP-climatic-data
  set-current-directory "C:/Users/Bernigaud Nicolas/Dropbox/RDMed_postdoc/Article_RDMed_2021/Soumission_PNAS/ROMCLIM_data/External_files"
  set P1_2200 gis:load-dataset "Climatic_data/PRECIP/Precip_2200BP_1.asc"; importation des précip. mensuelles de 2200 BP
  set P2_2200 gis:load-dataset "Climatic_data/PRECIP/Precip_2200BP_2.asc"
  set P3_2200 gis:load-dataset "Climatic_data/PRECIP/Precip_2200BP_3.asc"
  set P4_2200 gis:load-dataset "Climatic_data/PRECIP/Precip_2200BP_4.asc"
  set P5_2200 gis:load-dataset "Climatic_data/PRECIP/Precip_2200BP_5.asc"
  set P6_2200 gis:load-dataset "Climatic_data/PRECIP/Precip_2200BP_6.asc"
  set P7_2200 gis:load-dataset "Climatic_data/PRECIP/Precip_2200BP_7.asc"
  set P8_2200 gis:load-dataset "Climatic_data/PRECIP/Precip_2200BP_8.asc"
  set P9_2200 gis:load-dataset "Climatic_data/PRECIP/Precip_2200BP_9.asc"
  set P10_2200 gis:load-dataset "Climatic_data/PRECIP/Precip_2200BP_10.asc"
  set P11_2200 gis:load-dataset "Climatic_data/PRECIP/Precip_2200BP_11.asc"
  set P12_2200 gis:load-dataset "Climatic_data/PRECIP/Precip_2200BP_12.asc"

  set T1_2200 gis:load-dataset "Climatic_data/TEMP/Temp_2200BP_1.asc"; importation des temp. mensuelles de 2200 BP
  set T2_2200 gis:load-dataset "Climatic_data/TEMP/Temp_2200BP_2.asc"
  set T3_2200 gis:load-dataset "Climatic_data/TEMP/Temp_2200BP_3.asc"
  set T4_2200 gis:load-dataset "Climatic_data/TEMP/Temp_2200BP_4.asc"
  set T5_2200 gis:load-dataset "Climatic_data/TEMP/Temp_2200BP_5.asc"
  set T6_2200 gis:load-dataset "Climatic_data/TEMP/Temp_2200BP_6.asc"
  set T7_2200 gis:load-dataset "Climatic_data/TEMP/Temp_2200BP_7.asc"
  set T8_2200 gis:load-dataset "Climatic_data/TEMP/Temp_2200BP_8.asc"
  set T9_2200 gis:load-dataset "Climatic_data/TEMP/Temp_2200BP_9.asc"
  set T10_2200 gis:load-dataset "Climatic_data/TEMP/Temp_2200BP_10.asc"
  set T11_2200 gis:load-dataset "Climatic_data/TEMP/Temp_2200BP_12.asc"
  set T12_2200 gis:load-dataset "Climatic_data/TEMP/Temp_2200BP_12.asc"
end

to import-2100BP-climatic-data
  set-current-directory "C:/Users/Bernigaud Nicolas/Dropbox/RDMed_postdoc/Article_RDMed_2021/Soumission_PNAS/ROMCLIM_data/External_files"
  set P1_2100 gis:load-dataset "Climatic_data/PRECIP/Precip_2100BP_1.asc"; importation des précip. mensuelles de 2100 BP
  set P2_2100 gis:load-dataset "Climatic_data/PRECIP/Precip_2100BP_2.asc"
  set P3_2100 gis:load-dataset "Climatic_data/PRECIP/Precip_2100BP_3.asc"
  set P4_2100 gis:load-dataset "Climatic_data/PRECIP/Precip_2100BP_4.asc"
  set P5_2100 gis:load-dataset "Climatic_data/PRECIP/Precip_2100BP_5.asc"
  set P6_2100 gis:load-dataset "Climatic_data/PRECIP/Precip_2100BP_6.asc"
  set P7_2100 gis:load-dataset "Climatic_data/PRECIP/Precip_2100BP_7.asc"
  set P8_2100 gis:load-dataset "Climatic_data/PRECIP/Precip_2100BP_8.asc"
  set P9_2100 gis:load-dataset "Climatic_data/PRECIP/Precip_2100BP_9.asc"
  set P10_2100 gis:load-dataset "Climatic_data/PRECIP/Precip_2100BP_10.asc"
  set P11_2100 gis:load-dataset "Climatic_data/PRECIP/Precip_2100BP_11.asc"
  set P12_2100 gis:load-dataset "Climatic_data/PRECIP/Precip_2100BP_12.asc"

  set T1_2100 gis:load-dataset "Climatic_data/TEMP/Temp_2100BP_1.asc"; importation des temp. mensuelles de 2100 BP
  set T2_2100 gis:load-dataset "Climatic_data/TEMP/Temp_2100BP_2.asc"
  set T3_2100 gis:load-dataset "Climatic_data/TEMP/Temp_2100BP_3.asc"
  set T4_2100 gis:load-dataset "Climatic_data/TEMP/Temp_2100BP_4.asc"
  set T5_2100 gis:load-dataset "Climatic_data/TEMP/Temp_2100BP_5.asc"
  set T6_2100 gis:load-dataset "Climatic_data/TEMP/Temp_2100BP_6.asc"
  set T7_2100 gis:load-dataset "Climatic_data/TEMP/Temp_2100BP_7.asc"
  set T8_2100 gis:load-dataset "Climatic_data/TEMP/Temp_2100BP_8.asc"
  set T9_2100 gis:load-dataset "Climatic_data/TEMP/Temp_2100BP_9.asc"
  set T10_2100 gis:load-dataset "Climatic_data/TEMP/Temp_2100BP_10.asc"
  set T11_2100 gis:load-dataset "Climatic_data/TEMP/Temp_2100BP_12.asc"
  set T12_2100 gis:load-dataset "Climatic_data/TEMP/Temp_2100BP_12.asc"
end

to import-2500BP-LPJmL-data
  set WheatR_2500_LPJmL gis:load-dataset "C:/Users/Bernigaud Nicolas/Dropbox/Virtual_Meeting_EAA_2020/wheat_ASC/ASC/wheat_rainfed_tha_ag_2500BP.asc"
end

to import-2000BP-climatic-data
  set-current-directory "C:/Users/Bernigaud Nicolas/Dropbox/RDMed_postdoc/Article_RDMed_2021/Soumission_PNAS/ROMCLIM_data/External_files"
  set P1_2000 gis:load-dataset "Climatic_data/PRECIP/Precip_2000BP_1.asc"; importation précipitations mensuelles 2000 BP
  set P2_2000 gis:load-dataset "Climatic_data/PRECIP/Precip_2000BP_2.asc"
  set P3_2000 gis:load-dataset "Climatic_data/PRECIP/Precip_2000BP_3.asc"
  set P4_2000 gis:load-dataset "Climatic_data/PRECIP/Precip_2000BP_4.asc"
  set P5_2000 gis:load-dataset "Climatic_data/PRECIP/Precip_2000BP_5.asc"
  set P6_2000 gis:load-dataset "Climatic_data/PRECIP/Precip_2000BP_6.asc"
  set P7_2000 gis:load-dataset "Climatic_data/PRECIP/Precip_2000BP_7.asc"
  set P8_2000 gis:load-dataset "Climatic_data/PRECIP/Precip_2000BP_8.asc"
  set P9_2000 gis:load-dataset "Climatic_data/PRECIP/Precip_2000BP_9.asc"
  set P10_2000 gis:load-dataset "Climatic_data/PRECIP/Precip_2000BP_10.asc"
  set P11_2000 gis:load-dataset "Climatic_data/PRECIP/Precip_2000BP_11.asc"
  set P12_2000 gis:load-dataset "Climatic_data/PRECIP/Precip_2000BP_12.asc"

  set T1_2000 gis:load-dataset "Climatic_data/TEMP/Temp_2000BP_1.asc"; importations températures mensuelles 2000 BP
  set T2_2000 gis:load-dataset "Climatic_data/TEMP/Temp_2000BP_2.asc"
  set T3_2000 gis:load-dataset "Climatic_data/TEMP/Temp_2000BP_3.asc"
  set T4_2000 gis:load-dataset "Climatic_data/TEMP/Temp_2000BP_4.asc"
  set T5_2000 gis:load-dataset "Climatic_data/TEMP/Temp_2000BP_5.asc"
  set T6_2000 gis:load-dataset "Climatic_data/TEMP/Temp_2000BP_6.asc"
  set T7_2000 gis:load-dataset "Climatic_data/TEMP/Temp_2000BP_7.asc"
  set T8_2000 gis:load-dataset "Climatic_data/TEMP/Temp_2000BP_8.asc"
  set T9_2000 gis:load-dataset "Climatic_data/TEMP/Temp_2000BP_9.asc"
  set T10_2000 gis:load-dataset "Climatic_data/TEMP/Temp_2000BP_10.asc"
  set T11_2000 gis:load-dataset "Climatic_data/TEMP/Temp_2000BP_12.asc"
  set T12_2000 gis:load-dataset "Climatic_data/TEMP/Temp_2000BP_12.asc"
end

to import-1900BP-climatic-data
  set-current-directory "C:/Users/Bernigaud Nicolas/Dropbox/RDMed_postdoc/Article_RDMed_2021/Soumission_PNAS/ROMCLIM_data/External_files"
  set P1_1900 gis:load-dataset "Climatic_data/PRECIP/Precip_1900BP_1.asc"; importation précipitations mensuelles 1900 BP
  set P2_1900 gis:load-dataset "Climatic_data/PRECIP/Precip_1900BP_2.asc"
  set P3_1900 gis:load-dataset "Climatic_data/PRECIP/Precip_1900BP_3.asc"
  set P4_1900 gis:load-dataset "Climatic_data/PRECIP/Precip_1900BP_4.asc"
  set P5_1900 gis:load-dataset "Climatic_data/PRECIP/Precip_1900BP_5.asc"
  set P6_1900 gis:load-dataset "Climatic_data/PRECIP/Precip_1900BP_6.asc"
  set P7_1900 gis:load-dataset "Climatic_data/PRECIP/Precip_1900BP_7.asc"
  set P8_1900 gis:load-dataset "Climatic_data/PRECIP/Precip_1900BP_8.asc"
  set P9_1900 gis:load-dataset "Climatic_data/PRECIP/Precip_1900BP_9.asc"
  set P10_1900 gis:load-dataset "Climatic_data/PRECIP/Precip_1900BP_10.asc"
  set P11_1900 gis:load-dataset "Climatic_data/PRECIP/Precip_1900BP_11.asc"
  set P12_1900 gis:load-dataset "Climatic_data/PRECIP/Precip_1900BP_12.asc"

  set T1_1900 gis:load-dataset "Climatic_data/TEMP/Temp_1900BP_1.asc"; importations températures mensuelles 1900 BP
  set T2_1900 gis:load-dataset "Climatic_data/TEMP/Temp_1900BP_2.asc"
  set T3_1900 gis:load-dataset "Climatic_data/TEMP/Temp_1900BP_3.asc"
  set T4_1900 gis:load-dataset "Climatic_data/TEMP/Temp_1900BP_4.asc"
  set T5_1900 gis:load-dataset "Climatic_data/TEMP/Temp_1900BP_5.asc"
  set T6_1900 gis:load-dataset "Climatic_data/TEMP/Temp_1900BP_6.asc"
  set T7_1900 gis:load-dataset "Climatic_data/TEMP/Temp_1900BP_7.asc"
  set T8_1900 gis:load-dataset "Climatic_data/TEMP/Temp_1900BP_8.asc"
  set T9_1900 gis:load-dataset "Climatic_data/TEMP/Temp_1900BP_9.asc"
  set T10_1900 gis:load-dataset "Climatic_data/TEMP/Temp_1900BP_10.asc"
  set T11_1900 gis:load-dataset "Climatic_data/TEMP/Temp_1900BP_12.asc"
  set T12_1900 gis:load-dataset "Climatic_data/TEMP/Temp_1900BP_12.asc"
end

to import-1800BP-climatic-data
  set-current-directory "C:/Users/Bernigaud Nicolas/Dropbox/RDMed_postdoc/Article_RDMed_2021/Soumission_PNAS/ROMCLIM_data/External_files"
  set P1_1800 gis:load-dataset "Climatic_data/PRECIP/Precip_1800BP_1.asc"; importation précipitations mensuelles 1800 BP
  set P2_1800 gis:load-dataset "Climatic_data/PRECIP/Precip_1800BP_2.asc"
  set P3_1800 gis:load-dataset "Climatic_data/PRECIP/Precip_1800BP_3.asc"
  set P4_1800 gis:load-dataset "Climatic_data/PRECIP/Precip_1800BP_4.asc"
  set P5_1800 gis:load-dataset "Climatic_data/PRECIP/Precip_1800BP_5.asc"
  set P6_1800 gis:load-dataset "Climatic_data/PRECIP/Precip_1800BP_6.asc"
  set P7_1800 gis:load-dataset "Climatic_data/PRECIP/Precip_1800BP_7.asc"
  set P8_1800 gis:load-dataset "Climatic_data/PRECIP/Precip_1800BP_8.asc"
  set P9_1800 gis:load-dataset "Climatic_data/PRECIP/Precip_1800BP_9.asc"
  set P10_1800 gis:load-dataset "Climatic_data/PRECIP/Precip_1800BP_10.asc"
  set P11_1800 gis:load-dataset "Climatic_data/PRECIP/Precip_1800BP_11.asc"
  set P12_1800 gis:load-dataset "Climatic_data/PRECIP/Precip_1800BP_12.asc"

  set T1_1800 gis:load-dataset "Climatic_data/TEMP/Temp_1800BP_1.asc"; importations températures mensuelles 1800 BP
  set T2_1800 gis:load-dataset "Climatic_data/TEMP/Temp_1800BP_2.asc"
  set T3_1800 gis:load-dataset "Climatic_data/TEMP/Temp_1800BP_3.asc"
  set T4_1800 gis:load-dataset "Climatic_data/TEMP/Temp_1800BP_4.asc"
  set T5_1800 gis:load-dataset "Climatic_data/TEMP/Temp_1800BP_5.asc"
  set T6_1800 gis:load-dataset "Climatic_data/TEMP/Temp_1800BP_6.asc"
  set T7_1800 gis:load-dataset "Climatic_data/TEMP/Temp_1800BP_7.asc"
  set T8_1800 gis:load-dataset "Climatic_data/TEMP/Temp_1800BP_8.asc"
  set T9_1800 gis:load-dataset "Climatic_data/TEMP/Temp_1800BP_9.asc"
  set T10_1800 gis:load-dataset "Climatic_data/TEMP/Temp_1800BP_10.asc"
  set T11_1800 gis:load-dataset "Climatic_data/TEMP/Temp_1800BP_12.asc"
  set T12_1800 gis:load-dataset "Climatic_data/TEMP/Temp_1800BP_12.asc"
end

to import-1700BP-climatic-data
  set-current-directory "C:/Users/Bernigaud Nicolas/Dropbox/RDMed_postdoc/Article_RDMed_2021/Soumission_PNAS/ROMCLIM_data/External_files"
  set P1_1700 gis:load-dataset "Climatic_data/PRECIP/Precip_1700BP_1.asc"; importation précipitations mensuelles 1700 BP
  set P2_1700 gis:load-dataset "Climatic_data/PRECIP/Precip_1700BP_2.asc"
  set P3_1700 gis:load-dataset "Climatic_data/PRECIP/Precip_1700BP_3.asc"
  set P4_1700 gis:load-dataset "Climatic_data/PRECIP/Precip_1700BP_4.asc"
  set P5_1700 gis:load-dataset "Climatic_data/PRECIP/Precip_1700BP_5.asc"
  set P6_1700 gis:load-dataset "Climatic_data/PRECIP/Precip_1700BP_6.asc"
  set P7_1700 gis:load-dataset "Climatic_data/PRECIP/Precip_1700BP_7.asc"
  set P8_1700 gis:load-dataset "Climatic_data/PRECIP/Precip_1700BP_8.asc"
  set P9_1700 gis:load-dataset "Climatic_data/PRECIP/Precip_1700BP_9.asc"
  set P10_1700 gis:load-dataset "Climatic_data/PRECIP/Precip_1700BP_10.asc"
  set P11_1700 gis:load-dataset "Climatic_data/PRECIP/Precip_1700BP_11.asc"
  set P12_1700 gis:load-dataset "Climatic_data/PRECIP/Precip_1700BP_12.asc"

  set T1_1700 gis:load-dataset "Climatic_data/TEMP/Temp_1700BP_1.asc"; importations températures mensuelles 1700 BP
  set T2_1700 gis:load-dataset "Climatic_data/TEMP/Temp_1700BP_2.asc"
  set T3_1700 gis:load-dataset "Climatic_data/TEMP/Temp_1700BP_3.asc"
  set T4_1700 gis:load-dataset "Climatic_data/TEMP/Temp_1700BP_4.asc"
  set T5_1700 gis:load-dataset "Climatic_data/TEMP/Temp_1700BP_5.asc"
  set T6_1700 gis:load-dataset "Climatic_data/TEMP/Temp_1700BP_6.asc"
  set T7_1700 gis:load-dataset "Climatic_data/TEMP/Temp_1700BP_7.asc"
  set T8_1700 gis:load-dataset "Climatic_data/TEMP/Temp_1700BP_8.asc"
  set T9_1700 gis:load-dataset "Climatic_data/TEMP/Temp_1700BP_9.asc"
  set T10_1700 gis:load-dataset "Climatic_data/TEMP/Temp_1700BP_10.asc"
  set T11_1700 gis:load-dataset "Climatic_data/TEMP/Temp_1700BP_12.asc"
  set T12_1700 gis:load-dataset "Climatic_data/TEMP/Temp_1700BP_12.asc"
end

to import-1600BP-climatic-data
  set-current-directory "C:/Users/Bernigaud Nicolas/Dropbox/RDMed_postdoc/Article_RDMed_2021/Soumission_PNAS/ROMCLIM_data/External_files"
  set P1_1600 gis:load-dataset "Climatic_data/PRECIP/Precip_1600BP_1.asc"; importation précipitations mensuelles 1600 BP
  set P2_1600 gis:load-dataset "Climatic_data/PRECIP/Precip_1600BP_2.asc"
  set P3_1600 gis:load-dataset "Climatic_data/PRECIP/Precip_1600BP_3.asc"
  set P4_1600 gis:load-dataset "Climatic_data/PRECIP/Precip_1600BP_4.asc"
  set P5_1600 gis:load-dataset "Climatic_data/PRECIP/Precip_1600BP_5.asc"
  set P6_1600 gis:load-dataset "Climatic_data/PRECIP/Precip_1600BP_6.asc"
  set P7_1600 gis:load-dataset "Climatic_data/PRECIP/Precip_1600BP_7.asc"
  set P8_1600 gis:load-dataset "Climatic_data/PRECIP/Precip_1600BP_8.asc"
  set P9_1600 gis:load-dataset "Climatic_data/PRECIP/Precip_1600BP_9.asc"
  set P10_1600 gis:load-dataset "Climatic_data/PRECIP/Precip_1600BP_10.asc"
  set P11_1600 gis:load-dataset "Climatic_data/PRECIP/Precip_1600BP_11.asc"
  set P12_1600 gis:load-dataset "Climatic_data/PRECIP/Precip_1600BP_12.asc"

  set T1_1600 gis:load-dataset "Climatic_data/TEMP/Temp_1600BP_1.asc"; importations températures mensuelles 1600 BP
  set T2_1600 gis:load-dataset "Climatic_data/TEMP/Temp_1600BP_2.asc"
  set T3_1600 gis:load-dataset "Climatic_data/TEMP/Temp_1600BP_3.asc"
  set T4_1600 gis:load-dataset "Climatic_data/TEMP/Temp_1600BP_4.asc"
  set T5_1600 gis:load-dataset "Climatic_data/TEMP/Temp_1600BP_5.asc"
  set T6_1600 gis:load-dataset "Climatic_data/TEMP/Temp_1600BP_6.asc"
  set T7_1600 gis:load-dataset "Climatic_data/TEMP/Temp_1600BP_7.asc"
  set T8_1600 gis:load-dataset "Climatic_data/TEMP/Temp_1600BP_8.asc"
  set T9_1600 gis:load-dataset "Climatic_data/TEMP/Temp_1600BP_9.asc"
  set T10_1600 gis:load-dataset "Climatic_data/TEMP/Temp_1600BP_10.asc"
  set T11_1600 gis:load-dataset "Climatic_data/TEMP/Temp_1600BP_12.asc"
  set T12_1600 gis:load-dataset "Climatic_data/TEMP/Temp_1600BP_12.asc"
end

to import-1500BP-climatic-data
  set-current-directory "C:/Users/Bernigaud Nicolas/Dropbox/RDMed_postdoc/Article_RDMed_2021/Soumission_PNAS/ROMCLIM_data/External_files"
  set P1_1500 gis:load-dataset "Climatic_data/PRECIP/Precip_1500BP_1.asc"; importation précipitations mensuelles 1500 BP
  set P2_1500 gis:load-dataset "Climatic_data/PRECIP/Precip_1500BP_2.asc"
  set P3_1500 gis:load-dataset "Climatic_data/PRECIP/Precip_1500BP_3.asc"
  set P4_1500 gis:load-dataset "Climatic_data/PRECIP/Precip_1500BP_4.asc"
  set P5_1500 gis:load-dataset "Climatic_data/PRECIP/Precip_1500BP_5.asc"
  set P6_1500 gis:load-dataset "Climatic_data/PRECIP/Precip_1500BP_6.asc"
  set P7_1500 gis:load-dataset "Climatic_data/PRECIP/Precip_1500BP_7.asc"
  set P8_1500 gis:load-dataset "Climatic_data/PRECIP/Precip_1500BP_8.asc"
  set P9_1500 gis:load-dataset "Climatic_data/PRECIP/Precip_1500BP_9.asc"
  set P10_1500 gis:load-dataset "Climatic_data/PRECIP/Precip_1500BP_10.asc"
  set P11_1500 gis:load-dataset "Climatic_data/PRECIP/Precip_1500BP_11.asc"
  set P12_1500 gis:load-dataset "Climatic_data/PRECIP/Precip_1500BP_12.asc"

  set T1_1500 gis:load-dataset "Climatic_data/TEMP/Temp_1500BP_1.asc"; importations températures mensuelles 1500 BP
  set T2_1500 gis:load-dataset "Climatic_data/TEMP/Temp_1500BP_2.asc"
  set T3_1500 gis:load-dataset "Climatic_data/TEMP/Temp_1500BP_3.asc"
  set T4_1500 gis:load-dataset "Climatic_data/TEMP/Temp_1500BP_4.asc"
  set T5_1500 gis:load-dataset "Climatic_data/TEMP/Temp_1500BP_5.asc"
  set T6_1500 gis:load-dataset "Climatic_data/TEMP/Temp_1500BP_6.asc"
  set T7_1500 gis:load-dataset "Climatic_data/TEMP/Temp_1500BP_7.asc"
  set T8_1500 gis:load-dataset "Climatic_data/TEMP/Temp_1500BP_8.asc"
  set T9_1500 gis:load-dataset "Climatic_data/TEMP/Temp_1500BP_9.asc"
  set T10_1500 gis:load-dataset "Climatic_data/TEMP/Temp_1500BP_10.asc"
  set T11_1500 gis:load-dataset "Climatic_data/TEMP/Temp_1500BP_12.asc"
  set T12_1500 gis:load-dataset "Climatic_data/TEMP/Temp_1500BP_12.asc"
end

to import-1400BP-climatic-data
  set-current-directory "C:/Users/Bernigaud Nicolas/Dropbox/RDMed_postdoc/Article_RDMed_2021/Soumission_PNAS/ROMCLIM_data/External_files"
  set P1_1400 gis:load-dataset "Climatic_data/PRECIP/Precip_1400BP_1.asc"; importation précipitations mensuelles 1400 BP
  set P2_1400 gis:load-dataset "Climatic_data/PRECIP/Precip_1400BP_2.asc"
  set P3_1400 gis:load-dataset "Climatic_data/PRECIP/Precip_1400BP_3.asc"
  set P4_1400 gis:load-dataset "Climatic_data/PRECIP/Precip_1400BP_4.asc"
  set P5_1400 gis:load-dataset "Climatic_data/PRECIP/Precip_1400BP_5.asc"
  set P6_1400 gis:load-dataset "Climatic_data/PRECIP/Precip_1400BP_6.asc"
  set P7_1400 gis:load-dataset "Climatic_data/PRECIP/Precip_1400BP_7.asc"
  set P8_1400 gis:load-dataset "Climatic_data/PRECIP/Precip_1400BP_8.asc"
  set P9_1400 gis:load-dataset "Climatic_data/PRECIP/Precip_1400BP_9.asc"
  set P10_1400 gis:load-dataset "Climatic_data/PRECIP/Precip_1400BP_10.asc"
  set P11_1400 gis:load-dataset "Climatic_data/PRECIP/Precip_1400BP_11.asc"
  set P12_1400 gis:load-dataset "Climatic_data/PRECIP/Precip_1400BP_12.asc"

  set T1_1400 gis:load-dataset "Climatic_data/TEMP/Temp_1400BP_1.asc"; importations températures mensuelles 1400 BP
  set T2_1400 gis:load-dataset "Climatic_data/TEMP/Temp_1400BP_2.asc"
  set T3_1400 gis:load-dataset "Climatic_data/TEMP/Temp_1400BP_3.asc"
  set T4_1400 gis:load-dataset "Climatic_data/TEMP/Temp_1400BP_4.asc"
  set T5_1400 gis:load-dataset "Climatic_data/TEMP/Temp_1400BP_5.asc"
  set T6_1400 gis:load-dataset "Climatic_data/TEMP/Temp_1400BP_6.asc"
  set T7_1400 gis:load-dataset "Climatic_data/TEMP/Temp_1400BP_7.asc"
  set T8_1400 gis:load-dataset "Climatic_data/TEMP/Temp_1400BP_8.asc"
  set T9_1400 gis:load-dataset "Climatic_data/TEMP/Temp_1400BP_9.asc"
  set T10_1400 gis:load-dataset "Climatic_data/TEMP/Temp_1400BP_10.asc"
  set T11_1400 gis:load-dataset "Climatic_data/TEMP/Temp_1400BP_12.asc"
  set T12_1400 gis:load-dataset "Climatic_data/TEMP/Temp_1400BP_12.asc"
end

to import-1300BP-climatic-data
  set-current-directory "C:/Users/Bernigaud Nicolas/Dropbox/RDMed_postdoc/Article_RDMed_2021/Soumission_PNAS/ROMCLIM_data/External_files"
  set P1_1300 gis:load-dataset "Climatic_data/PRECIP/Precip_1300BP_1.asc"; importation précipitations mensuelles 1300 BP
  set P2_1300 gis:load-dataset "Climatic_data/PRECIP/Precip_1300BP_2.asc"
  set P3_1300 gis:load-dataset "Climatic_data/PRECIP/Precip_1300BP_3.asc"
  set P4_1300 gis:load-dataset "Climatic_data/PRECIP/Precip_1300BP_4.asc"
  set P5_1300 gis:load-dataset "Climatic_data/PRECIP/Precip_1300BP_5.asc"
  set P6_1300 gis:load-dataset "Climatic_data/PRECIP/Precip_1300BP_6.asc"
  set P7_1300 gis:load-dataset "Climatic_data/PRECIP/Precip_1300BP_7.asc"
  set P8_1300 gis:load-dataset "Climatic_data/PRECIP/Precip_1300BP_8.asc"
  set P9_1300 gis:load-dataset "Climatic_data/PRECIP/Precip_1300BP_9.asc"
  set P10_1300 gis:load-dataset "Climatic_data/PRECIP/Precip_1300BP_10.asc"
  set P11_1300 gis:load-dataset "Climatic_data/PRECIP/Precip_1300BP_11.asc"
  set P12_1300 gis:load-dataset "Climatic_data/PRECIP/Precip_1300BP_12.asc"

  set T1_1300 gis:load-dataset "Climatic_data/TEMP/Temp_1300BP_1.asc"; importations températures mensuelles 1300 BP
  set T2_1300 gis:load-dataset "Climatic_data/TEMP/Temp_1300BP_2.asc"
  set T3_1300 gis:load-dataset "Climatic_data/TEMP/Temp_1300BP_3.asc"
  set T4_1300 gis:load-dataset "Climatic_data/TEMP/Temp_1300BP_4.asc"
  set T5_1300 gis:load-dataset "Climatic_data/TEMP/Temp_1300BP_5.asc"
  set T6_1300 gis:load-dataset "Climatic_data/TEMP/Temp_1300BP_6.asc"
  set T7_1300 gis:load-dataset "Climatic_data/TEMP/Temp_1300BP_7.asc"
  set T8_1300 gis:load-dataset "Climatic_data/TEMP/Temp_1300BP_8.asc"
  set T9_1300 gis:load-dataset "Climatic_data/TEMP/Temp_1300BP_9.asc"
  set T10_1300 gis:load-dataset "Climatic_data/TEMP/Temp_1300BP_10.asc"
  set T11_1300 gis:load-dataset "Climatic_data/TEMP/Temp_1300BP_12.asc"
  set T12_1300 gis:load-dataset "Climatic_data/TEMP/Temp_1300BP_12.asc"
end

to import-REF-climatic-data
  set-current-directory "C:/Users/Bernigaud Nicolas/Dropbox/RDMed_postdoc/Article_RDMed_2021/Soumission_PNAS/ROMCLIM_data/External_files/Climatic_data/REF"
  ;set-current-directory "REF/Climatic_data/PRECIPITATIONS"
  set P1_REF gis:load-dataset "PRECIPITATIONS/ALADIN_PREC_REF_1.asc"
  set P2_REF gis:load-dataset "PRECIPITATIONS/ALADIN_PREC_REF_2.asc"
  set P3_REF gis:load-dataset "PRECIPITATIONS/ALADIN_PREC_REF_3.asc"
  set P4_REF gis:load-dataset "PRECIPITATIONS/ALADIN_PREC_REF_4.asc"
  set P5_REF gis:load-dataset "PRECIPITATIONS/ALADIN_PREC_REF_5.asc"
  set P6_REF gis:load-dataset "PRECIPITATIONS/ALADIN_PREC_REF_6.asc"
  set P7_REF gis:load-dataset "PRECIPITATIONS/ALADIN_PREC_REF_7.asc"
  set P8_REF gis:load-dataset "PRECIPITATIONS/ALADIN_PREC_REF_8.asc"
  set P9_REF gis:load-dataset "PRECIPITATIONS/ALADIN_PREC_REF_9.asc"
  set P10_REF gis:load-dataset "PRECIPITATIONS/ALADIN_PREC_REF_10.asc"
  set P11_REF gis:load-dataset "PRECIPITATIONS/ALADIN_PREC_REF_11.asc"
  set P12_REF gis:load-dataset "PRECIPITATIONS/ALADIN_PREC_REF_12.asc"
  ;set-current-directory "C:/Users/Bernigaud Nicolas/Dropbox/RDMed_postdoc/Article_RDMed_2021/Soumission_PNAS/ROMCLIM_data/External_files/Climatic_data/REF/Climatic_data/TEMPERATURES"
  ;set-current-directory "REF/Climatic_data/TEMPERATURES"
  set T1_REF gis:load-dataset "TEMPERATURES/ALADIN_TEMP_REF_1.asc"
  set T2_REF gis:load-dataset "TEMPERATURES/ALADIN_TEMP_REF_2.asc"
  set T3_REF gis:load-dataset "TEMPERATURES/ALADIN_TEMP_REF_3.asc"
  set T4_REF gis:load-dataset "TEMPERATURES/ALADIN_TEMP_REF_4.asc"
  set T5_REF gis:load-dataset "TEMPERATURES/ALADIN_TEMP_REF_5.asc"
  set T6_REF gis:load-dataset "TEMPERATURES/ALADIN_TEMP_REF_6.asc"
  set T7_REF gis:load-dataset "TEMPERATURES/ALADIN_TEMP_REF_7.asc"
  set T8_REF gis:load-dataset "TEMPERATURES/ALADIN_TEMP_REF_8.asc"
  set T9_REF gis:load-dataset "TEMPERATURES/ALADIN_TEMP_REF_9.asc"
  set T10_REF gis:load-dataset "TEMPERATURES/ALADIN_TEMP_REF_10.asc"
  set T11_REF gis:load-dataset "TEMPERATURES/ALADIN_TEMP_REF_11.asc"
  set T12_REF gis:load-dataset "TEMPERATURES/ALADIN_TEMP_REF_12.asc"
end

to apply-REF-climatic-data
gis:apply-raster P1_REF P1_REF_
gis:apply-raster P2_REF P2_REF_
gis:apply-raster P3_REF P3_REF_
gis:apply-raster P4_REF P4_REF_
gis:apply-raster P5_REF P5_REF_
gis:apply-raster P6_REF P6_REF_
gis:apply-raster P7_REF P7_REF_
gis:apply-raster P8_REF P8_REF_
gis:apply-raster P9_REF P9_REF_
gis:apply-raster P10_REF P10_REF_
gis:apply-raster P11_REF P11_REF_
gis:apply-raster P12_REF P12_REF_

gis:apply-raster T1_REF T1_REF_
gis:apply-raster T2_REF T2_REF_
gis:apply-raster T3_REF T3_REF_
gis:apply-raster T4_REF T4_REF_
gis:apply-raster T5_REF T5_REF_
gis:apply-raster T6_REF T6_REF_
gis:apply-raster T7_REF T7_REF_
gis:apply-raster T8_REF T8_REF_
gis:apply-raster T9_REF T9_REF_
gis:apply-raster T10_REF T10_REF_
gis:apply-raster T11_REF T11_REF_
gis:apply-raster T12_REF T12_REF_
end

to import-Grapes-LPJmL
  set-current-directory "C:/Users/Bernigaud Nicolas/Dropbox/LPJmL_Alberte_2020/grapes_LScor_ASC/grapes_LScor_ASC"
  set GR_2500 gis:load-dataset "grapes_rainfed_hlha_ag_2500BP_LScor.asc"
  set GR_2400 gis:load-dataset "grapes_rainfed_hlha_ag_2400BP_LScor.asc"
  set GR_2300 gis:load-dataset "grapes_rainfed_hlha_ag_2300BP_LScor.asc"
  set GR_2200 gis:load-dataset "grapes_rainfed_hlha_ag_2200BP_LScor.asc"
  set GR_2100 gis:load-dataset "grapes_rainfed_hlha_ag_2100BP_LScor.asc"
  set GR_2000 gis:load-dataset "grapes_rainfed_hlha_ag_2000BP_LScor.asc"
  set GR_1900 gis:load-dataset "grapes_rainfed_hlha_ag_1900BP_LScor.asc"
  set GR_1800 gis:load-dataset "grapes_rainfed_hlha_ag_1800BP_LScor.asc"
  set GR_1700 gis:load-dataset "grapes_rainfed_hlha_ag_1700BP_LScor.asc"
  set GR_1600 gis:load-dataset "grapes_rainfed_hlha_ag_1600BP_LScor.asc"
  set GR_1500 gis:load-dataset "grapes_rainfed_hlha_ag_1500BP_LScor.asc"
  set GR_1400 gis:load-dataset "grapes_rainfed_hlha_ag_1400BP_LScor.asc"
  set GR_1300 gis:load-dataset "grapes_rainfed_hlha_ag_1300BP_LScor.asc"
end

to apply-Grapes-LPJmL
  gis:apply-raster GR_2500 GR_2500_
  gis:apply-raster GR_2400 GR_2400_
  gis:apply-raster GR_2200 GR_2200_
  gis:apply-raster GR_2200 GR_2200_
  gis:apply-raster GR_2100 GR_2100_
  gis:apply-raster GR_2000 GR_2000_
  gis:apply-raster GR_1900 GR_1900_
  gis:apply-raster GR_1800 GR_1800_
  gis:apply-raster GR_1700 GR_1700_
  gis:apply-raster GR_1600 GR_1600_
  gis:apply-raster GR_1500 GR_1500_
  gis:apply-raster GR_1400 GR_1400_
  gis:apply-raster GR_1300 GR_1300_
end

to import-Olives-LPJmL
  set-current-directory "C:/Users/Bernigaud Nicolas/Dropbox/LPJmL_Alberte_2020/olive_LScor_ASC/olive_LScor_ASC"
  set OR_2500 gis:load-dataset "olives_rainfed_tha_ag_2500BP_LScor.asc"
  set OR_2400 gis:load-dataset "olives_rainfed_tha_ag_2400BP_LScor.asc"
  set OR_2300 gis:load-dataset "olives_rainfed_tha_ag_2300BP_LScor.asc"
  set OR_2200 gis:load-dataset "olives_rainfed_tha_ag_2200BP_LScor.asc"
  set OR_2100 gis:load-dataset "olives_rainfed_tha_ag_2100BP_LScor.asc"
  set OR_2000 gis:load-dataset "olives_rainfed_tha_ag_2000BP_LScor.asc"
  set OR_1900 gis:load-dataset "olives_rainfed_tha_ag_1900BP_LScor.asc"
  set OR_1800 gis:load-dataset "olives_rainfed_tha_ag_1800BP_LScor.asc"
  set OR_1700 gis:load-dataset "olives_rainfed_tha_ag_1700BP_LScor.asc"
  set OR_1600 gis:load-dataset "olives_rainfed_tha_ag_1600BP_LScor.asc"
  set OR_1500 gis:load-dataset "olives_rainfed_tha_ag_1500BP_LScor.asc"
  set OR_1400 gis:load-dataset "olives_rainfed_tha_ag_1400BP_LScor.asc"
  set OR_1300 gis:load-dataset "olives_rainfed_tha_ag_1300BP_LScor.asc"
end

to apply-Olives-LPJmL
  gis:apply-raster OR_2500 OR_2500_
  gis:apply-raster OR_2400 OR_2400_
  gis:apply-raster OR_2200 OR_2200_
  gis:apply-raster OR_2200 OR_2200_
  gis:apply-raster OR_2100 OR_2100_
  gis:apply-raster OR_2000 OR_2000_
  gis:apply-raster OR_1900 OR_1900_
  gis:apply-raster OR_1800 OR_1800_
  gis:apply-raster OR_1700 OR_1700_
  gis:apply-raster OR_1600 OR_1600_
  gis:apply-raster OR_1500 OR_1500_
  gis:apply-raster OR_1400 OR_1400_
  gis:apply-raster OR_1300 OR_1300_
end

to apply-2500BP-climatic-data
  gis:apply-raster P1_2500 P1_2500BP
  gis:apply-raster P2_2500 P2_2500BP
  gis:apply-raster P3_2500 P3_2500BP
  gis:apply-raster P4_2500 P4_2500BP
  gis:apply-raster P5_2500 P5_2500BP
  gis:apply-raster P6_2500 P6_2500BP
  gis:apply-raster P7_2500 P7_2500BP
  gis:apply-raster P8_2500 P8_2500BP
  gis:apply-raster P9_2500 P9_2500BP
  gis:apply-raster P10_2500 P10_2500BP
  gis:apply-raster P11_2500 P11_2500BP
  gis:apply-raster P12_2500 P12_2500BP

  gis:apply-raster T1_2500 T1_2500BP
  gis:apply-raster T2_2500 T2_2500BP
  gis:apply-raster T3_2500 T3_2500BP
  gis:apply-raster T4_2500 T4_2500BP
  gis:apply-raster T5_2500 T5_2500BP
  gis:apply-raster T6_2500 T6_2500BP
  gis:apply-raster T7_2500 T7_2500BP
  gis:apply-raster T8_2500 T8_2500BP
  gis:apply-raster T9_2500 T9_2500BP
  gis:apply-raster T10_2500 T10_2500BP
  gis:apply-raster T11_2500 T11_2500BP
  gis:apply-raster T12_2500 T12_2500BP
end

to apply-2400BP-climatic-data
  gis:apply-raster P1_2400 P1_2400BP
  gis:apply-raster P2_2400 P2_2400BP
  gis:apply-raster P3_2400 P3_2400BP
  gis:apply-raster P4_2400 P4_2400BP
  gis:apply-raster P5_2400 P5_2400BP
  gis:apply-raster P6_2400 P6_2400BP
  gis:apply-raster P7_2400 P7_2400BP
  gis:apply-raster P8_2400 P8_2400BP
  gis:apply-raster P9_2400 P9_2400BP
  gis:apply-raster P10_2400 P10_2400BP
  gis:apply-raster P11_2400 P11_2400BP
  gis:apply-raster P12_2400 P12_2400BP

  gis:apply-raster T1_2400 T1_2400BP
  gis:apply-raster T2_2400 T2_2400BP
  gis:apply-raster T3_2400 T3_2400BP
  gis:apply-raster T4_2400 T4_2400BP
  gis:apply-raster T5_2400 T5_2400BP
  gis:apply-raster T6_2400 T6_2400BP
  gis:apply-raster T7_2400 T7_2400BP
  gis:apply-raster T8_2400 T8_2400BP
  gis:apply-raster T9_2400 T9_2400BP
  gis:apply-raster T10_2400 T10_2400BP
  gis:apply-raster T11_2400 T11_2400BP
  gis:apply-raster T12_2400 T12_2400BP
end

to apply-2300BP-climatic-data
  gis:apply-raster P1_2300 P1_2300BP
  gis:apply-raster P2_2300 P2_2300BP
  gis:apply-raster P3_2300 P3_2300BP
  gis:apply-raster P4_2300 P4_2300BP
  gis:apply-raster P5_2300 P5_2300BP
  gis:apply-raster P6_2300 P6_2300BP
  gis:apply-raster P7_2300 P7_2300BP
  gis:apply-raster P8_2300 P8_2300BP
  gis:apply-raster P9_2300 P9_2300BP
  gis:apply-raster P10_2300 P10_2300BP
  gis:apply-raster P11_2300 P11_2300BP
  gis:apply-raster P12_2300 P12_2300BP

  gis:apply-raster T1_2300 T1_2300BP
  gis:apply-raster T2_2300 T2_2300BP
  gis:apply-raster T3_2300 T3_2300BP
  gis:apply-raster T4_2300 T4_2300BP
  gis:apply-raster T5_2300 T5_2300BP
  gis:apply-raster T6_2300 T6_2300BP
  gis:apply-raster T7_2300 T7_2300BP
  gis:apply-raster T8_2300 T8_2300BP
  gis:apply-raster T9_2300 T9_2300BP
  gis:apply-raster T10_2300 T10_2300BP
  gis:apply-raster T11_2300 T11_2300BP
  gis:apply-raster T12_2300 T12_2300BP
end

to apply-2200BP-climatic-data
  gis:apply-raster P1_2200 P1_2200BP
  gis:apply-raster P2_2200 P2_2200BP
  gis:apply-raster P3_2200 P3_2200BP
  gis:apply-raster P4_2200 P4_2200BP
  gis:apply-raster P5_2200 P5_2200BP
  gis:apply-raster P6_2200 P6_2200BP
  gis:apply-raster P7_2200 P7_2200BP
  gis:apply-raster P8_2200 P8_2200BP
  gis:apply-raster P9_2200 P9_2200BP
  gis:apply-raster P10_2200 P10_2200BP
  gis:apply-raster P11_2200 P11_2200BP
  gis:apply-raster P12_2200 P12_2200BP

  gis:apply-raster T1_2200 T1_2200BP
  gis:apply-raster T2_2200 T2_2200BP
  gis:apply-raster T3_2200 T3_2200BP
  gis:apply-raster T4_2200 T4_2200BP
  gis:apply-raster T5_2200 T5_2200BP
  gis:apply-raster T6_2200 T6_2200BP
  gis:apply-raster T7_2200 T7_2200BP
  gis:apply-raster T8_2200 T8_2200BP
  gis:apply-raster T9_2200 T9_2200BP
  gis:apply-raster T10_2200 T10_2200BP
  gis:apply-raster T11_2200 T11_2200BP
  gis:apply-raster T12_2200 T12_2200BP
end

to apply-2100BP-climatic-data
  gis:apply-raster P1_2100 P1_2100BP
  gis:apply-raster P2_2100 P2_2100BP
  gis:apply-raster P3_2100 P3_2100BP
  gis:apply-raster P4_2100 P4_2100BP
  gis:apply-raster P5_2100 P5_2100BP
  gis:apply-raster P6_2100 P6_2100BP
  gis:apply-raster P7_2100 P7_2100BP
  gis:apply-raster P8_2100 P8_2100BP
  gis:apply-raster P9_2100 P9_2100BP
  gis:apply-raster P10_2100 P10_2100BP
  gis:apply-raster P11_2100 P11_2100BP
  gis:apply-raster P12_2100 P12_2100BP

  gis:apply-raster T1_2100 T1_2100BP
  gis:apply-raster T2_2100 T2_2100BP
  gis:apply-raster T3_2100 T3_2100BP
  gis:apply-raster T4_2100 T4_2100BP
  gis:apply-raster T5_2100 T5_2100BP
  gis:apply-raster T6_2100 T6_2100BP
  gis:apply-raster T7_2100 T7_2100BP
  gis:apply-raster T8_2100 T8_2100BP
  gis:apply-raster T9_2100 T9_2100BP
  gis:apply-raster T10_2100 T10_2100BP
  gis:apply-raster T11_2100 T11_2100BP
  gis:apply-raster T12_2100 T12_2100BP
end

to apply-2000BP-climatic-data
  gis:apply-raster P1_2000 P1_2000BP
  gis:apply-raster P2_2000 P2_2000BP
  gis:apply-raster P3_2000 P3_2000BP
  gis:apply-raster P4_2000 P4_2000BP
  gis:apply-raster P5_2000 P5_2000BP
  gis:apply-raster P6_2000 P6_2000BP
  gis:apply-raster P7_2000 P7_2000BP
  gis:apply-raster P8_2000 P8_2000BP
  gis:apply-raster P9_2000 P9_2000BP
  gis:apply-raster P10_2000 P10_2000BP
  gis:apply-raster P11_2000 P11_2000BP
  gis:apply-raster P12_2000 P12_2000BP

  gis:apply-raster T1_2000 T1_2000BP
  gis:apply-raster T2_2000 T2_2000BP
  gis:apply-raster T3_2000 T3_2000BP
  gis:apply-raster T4_2000 T4_2000BP
  gis:apply-raster T5_2000 T5_2000BP
  gis:apply-raster T6_2000 T6_2000BP
  gis:apply-raster T7_2000 T7_2000BP
  gis:apply-raster T8_2000 T8_2000BP
  gis:apply-raster T9_2000 T9_2000BP
  gis:apply-raster T10_2000 T10_2000BP
  gis:apply-raster T11_2000 T11_2000BP
  gis:apply-raster T12_2000 T12_2000BP
end

to apply-1900BP-climatic-data
  gis:apply-raster P1_1900 P1_1900BP
  gis:apply-raster P2_1900 P2_1900BP
  gis:apply-raster P3_1900 P3_1900BP
  gis:apply-raster P4_1900 P4_1900BP
  gis:apply-raster P5_1900 P5_1900BP
  gis:apply-raster P6_1900 P6_1900BP
  gis:apply-raster P7_1900 P7_1900BP
  gis:apply-raster P8_1900 P8_1900BP
  gis:apply-raster P9_1900 P9_1900BP
  gis:apply-raster P10_1900 P10_1900BP
  gis:apply-raster P11_1900 P11_1900BP
  gis:apply-raster P12_1900 P12_1900BP

  gis:apply-raster T1_1900 T1_1900BP
  gis:apply-raster T2_1900 T2_1900BP
  gis:apply-raster T3_1900 T3_1900BP
  gis:apply-raster T4_1900 T4_1900BP
  gis:apply-raster T5_1900 T5_1900BP
  gis:apply-raster T6_1900 T6_1900BP
  gis:apply-raster T7_1900 T7_1900BP
  gis:apply-raster T8_1900 T8_1900BP
  gis:apply-raster T9_1900 T9_1900BP
  gis:apply-raster T10_1900 T10_1900BP
  gis:apply-raster T11_1900 T11_1900BP
  gis:apply-raster T12_1900 T12_1900BP
end

to apply-1800BP-climatic-data
  gis:apply-raster P1_1800 P1_1800BP
  gis:apply-raster P2_1800 P2_1800BP
  gis:apply-raster P3_1800 P3_1800BP
  gis:apply-raster P4_1800 P4_1800BP
  gis:apply-raster P5_1800 P5_1800BP
  gis:apply-raster P6_1800 P6_1800BP
  gis:apply-raster P7_1800 P7_1800BP
  gis:apply-raster P8_1800 P8_1800BP
  gis:apply-raster P9_1800 P9_1800BP
  gis:apply-raster P10_1800 P10_1800BP
  gis:apply-raster P11_1800 P11_1800BP
  gis:apply-raster P12_1800 P12_1800BP

  gis:apply-raster T1_1800 T1_1800BP
  gis:apply-raster T2_1800 T2_1800BP
  gis:apply-raster T3_1800 T3_1800BP
  gis:apply-raster T4_1800 T4_1800BP
  gis:apply-raster T5_1800 T5_1800BP
  gis:apply-raster T6_1800 T6_1800BP
  gis:apply-raster T7_1800 T7_1800BP
  gis:apply-raster T8_1800 T8_1800BP
  gis:apply-raster T9_1800 T9_1800BP
  gis:apply-raster T10_1800 T10_1800BP
  gis:apply-raster T11_1800 T11_1800BP
  gis:apply-raster T12_1800 T12_1800BP
end

to apply-1700BP-climatic-data
  gis:apply-raster P1_1700 P1_1700BP
  gis:apply-raster P2_1700 P2_1700BP
  gis:apply-raster P3_1700 P3_1700BP
  gis:apply-raster P4_1700 P4_1700BP
  gis:apply-raster P5_1700 P5_1700BP
  gis:apply-raster P6_1700 P6_1700BP
  gis:apply-raster P7_1700 P7_1700BP
  gis:apply-raster P8_1700 P8_1700BP
  gis:apply-raster P9_1700 P9_1700BP
  gis:apply-raster P10_1700 P10_1700BP
  gis:apply-raster P11_1700 P11_1700BP
  gis:apply-raster P12_1700 P12_1700BP

  gis:apply-raster T1_1700 T1_1700BP
  gis:apply-raster T2_1700 T2_1700BP
  gis:apply-raster T3_1700 T3_1700BP
  gis:apply-raster T4_1700 T4_1700BP
  gis:apply-raster T5_1700 T5_1700BP
  gis:apply-raster T6_1700 T6_1700BP
  gis:apply-raster T7_1700 T7_1700BP
  gis:apply-raster T8_1700 T8_1700BP
  gis:apply-raster T9_1700 T9_1700BP
  gis:apply-raster T10_1700 T10_1700BP
  gis:apply-raster T11_1700 T11_1700BP
  gis:apply-raster T12_1700 T12_1700BP
end

to apply-1600BP-climatic-data
  gis:apply-raster P1_1600 P1_1600BP
  gis:apply-raster P2_1600 P2_1600BP
  gis:apply-raster P3_1600 P3_1600BP
  gis:apply-raster P4_1600 P4_1600BP
  gis:apply-raster P5_1600 P5_1600BP
  gis:apply-raster P6_1600 P6_1600BP
  gis:apply-raster P7_1600 P7_1600BP
  gis:apply-raster P8_1600 P8_1600BP
  gis:apply-raster P9_1600 P9_1600BP
  gis:apply-raster P10_1600 P10_1600BP
  gis:apply-raster P11_1600 P11_1600BP
  gis:apply-raster P12_1600 P12_1600BP

  gis:apply-raster T1_1600 T1_1600BP
  gis:apply-raster T2_1600 T2_1600BP
  gis:apply-raster T3_1600 T3_1600BP
  gis:apply-raster T4_1600 T4_1600BP
  gis:apply-raster T5_1600 T5_1600BP
  gis:apply-raster T6_1600 T6_1600BP
  gis:apply-raster T7_1600 T7_1600BP
  gis:apply-raster T8_1600 T8_1600BP
  gis:apply-raster T9_1600 T9_1600BP
  gis:apply-raster T10_1600 T10_1600BP
  gis:apply-raster T11_1600 T11_1600BP
  gis:apply-raster T12_1600 T12_1600BP
end

to apply-1500BP-climatic-data
  gis:apply-raster P1_1500 P1_1500BP
  gis:apply-raster P2_1500 P2_1500BP
  gis:apply-raster P3_1500 P3_1500BP
  gis:apply-raster P4_1500 P4_1500BP
  gis:apply-raster P5_1500 P5_1500BP
  gis:apply-raster P6_1500 P6_1500BP
  gis:apply-raster P7_1500 P7_1500BP
  gis:apply-raster P8_1500 P8_1500BP
  gis:apply-raster P9_1500 P9_1500BP
  gis:apply-raster P10_1500 P10_1500BP
  gis:apply-raster P11_1500 P11_1500BP
  gis:apply-raster P12_1500 P12_1500BP

  gis:apply-raster T1_1500 T1_1500BP
  gis:apply-raster T2_1500 T2_1500BP
  gis:apply-raster T3_1500 T3_1500BP
  gis:apply-raster T4_1500 T4_1500BP
  gis:apply-raster T5_1500 T5_1500BP
  gis:apply-raster T6_1500 T6_1500BP
  gis:apply-raster T7_1500 T7_1500BP
  gis:apply-raster T8_1500 T8_1500BP
  gis:apply-raster T9_1500 T9_1500BP
  gis:apply-raster T10_1500 T10_1500BP
  gis:apply-raster T11_1500 T11_1500BP
  gis:apply-raster T12_1500 T12_1500BP
end

to apply-1400BP-climatic-data
  gis:apply-raster P1_1400 P1_1400BP
  gis:apply-raster P2_1400 P2_1400BP
  gis:apply-raster P3_1400 P3_1400BP
  gis:apply-raster P4_1400 P4_1400BP
  gis:apply-raster P5_1400 P5_1400BP
  gis:apply-raster P6_1400 P6_1400BP
  gis:apply-raster P7_1400 P7_1400BP
  gis:apply-raster P8_1400 P8_1400BP
  gis:apply-raster P9_1400 P9_1400BP
  gis:apply-raster P10_1400 P10_1400BP
  gis:apply-raster P11_1400 P11_1400BP
  gis:apply-raster P12_1400 P12_1400BP

  gis:apply-raster T1_1400 T1_1400BP
  gis:apply-raster T2_1400 T2_1400BP
  gis:apply-raster T3_1400 T3_1400BP
  gis:apply-raster T4_1400 T4_1400BP
  gis:apply-raster T5_1400 T5_1400BP
  gis:apply-raster T6_1400 T6_1400BP
  gis:apply-raster T7_1400 T7_1400BP
  gis:apply-raster T8_1400 T8_1400BP
  gis:apply-raster T9_1400 T9_1400BP
  gis:apply-raster T10_1400 T10_1400BP
  gis:apply-raster T11_1400 T11_1400BP
  gis:apply-raster T12_1400 T12_1400BP
end

to apply-1300BP-climatic-data
  gis:apply-raster P1_1300 P1_1300BP
  gis:apply-raster P2_1300 P2_1300BP
  gis:apply-raster P3_1300 P3_1300BP
  gis:apply-raster P4_1300 P4_1300BP
  gis:apply-raster P5_1300 P5_1300BP
  gis:apply-raster P6_1300 P6_1300BP
  gis:apply-raster P7_1300 P7_1300BP
  gis:apply-raster P8_1300 P8_1300BP
  gis:apply-raster P9_1300 P9_1300BP
  gis:apply-raster P10_1300 P10_1300BP
  gis:apply-raster P11_1300 P11_1300BP
  gis:apply-raster P12_1300 P12_1300BP

  gis:apply-raster T1_1300 T1_1300BP
  gis:apply-raster T2_1300 T2_1300BP
  gis:apply-raster T3_1300 T3_1300BP
  gis:apply-raster T4_1300 T4_1300BP
  gis:apply-raster T5_1300 T5_1300BP
  gis:apply-raster T6_1300 T6_1300BP
  gis:apply-raster T7_1300 T7_1300BP
  gis:apply-raster T8_1300 T8_1300BP
  gis:apply-raster T9_1300 T9_1300BP
  gis:apply-raster T10_1300 T10_1300BP
  gis:apply-raster T11_1300 T11_1300BP
  gis:apply-raster T12_1300 T12_1300BP
end

;to apply-2500BP-LPJmL-data
  ;gis:apply-raster WheatR_2500_LPJmL WheatR_2500BP_LPJmL
;end

to compute-climatic-data-REF
   ask patches [
    ifelse T12_REF_ >= 0 or T12_REF_ <= 0 or T1_REF_ >= 0 or T1_REF_ <= 0 or T2_REF_ >= 0 or T2_REF_ <= 0 [
      set Thiv (T12_REF_ + T1_REF_ + T2_REF_) / 3] [set Thiv -9999]; moyenne des T hivernales
    ifelse T3_REF_ >= 0 or T3_REF_ <= 0 or T4_REF_ >= 0 or T4_REF_ <= 0 or T5_REF_ >= 0 or T5_REF_ <= 0  [
      set Tprt (T3_REF_ + T4_REF_ + T5_REF_) / 3] [set Tprt -9999]; moyenne des T printannières
    ifelse T6_REF_ >= 0 or  T6_REF_ <= 0 or T7_REF_ >= 0 or T7_REF_ <= 0 or T8_REF_ >= 0 or T8_REF_ <= 0  [
      set Tete (T6_REF_ + T7_REF_ + T8_REF_) / 3] [set Tete -9999]; moyenne des T estivales
    ifelse T9_REF_ >= 0 or T9_REF_ <= 0 or T10_REF_ >= 0 or T10_REF_ <= 0 or T11_REF_ >= 0 or T11_REF_ <= 0 [
      set Taut (T9_REF_ + T10_REF_ + T11_REF_) / 3] [set Taut -9999]; moyenne des T automnales
    ifelse P12_REF_ >= 0 or P1_REF_ >= 0 or P2_REF_ >= 0 [
      set Phiv P12_REF_ + P1_REF_ + P2_REF_] [set Phiv -9999]; cumul des P hivernales
    ifelse P3_REF_ >= 0 or P4_REF_ >= 0 or P5_REF_ >= 0 [
      set Pprt P3_REF_ + P4_REF_ + P5_REF_] [set Pprt -9999]; cumul des P printannières
    ifelse P6_REF_ >= 0 or P7_REF_ >= 0 or P8_REF_ >= 0 [
      set Pete P6_REF_ + P7_REF_ + P8_REF_] [set Pete -9999]; cumul des P estivales
    ifelse P9_REF_ >= 0 or P10_REF_ >= 0 or P11_REF_ >= 0 [
      set Paut P9_REF_ + P10_REF_ + P11_REF_] [set Paut -9999]; cumul des P automnales
  ]
end

to compute-climatic-data-2500BP
   ask patches [
    ;ifelse T12_2500BP != -9999 or T1_2500BP != -9999 or T2_2500BP != -9999 [
      ;set Thiv (T12_2500BP + T1_2500BP + T2_2500BP) / 3] [set Thiv 0]
    ifelse T12_2500BP >= 0 or T12_2500BP <= 0 or T1_2500BP >= 0 or T1_2500BP <= 0 or T2_2500BP >= 0 or T2_2500BP <= 0 [
      set Thiv (T12_2500BP + T1_2500BP + T2_2500BP) / 3] [set Thiv -9999]; moyenne des T hivernales
    ifelse T3_2500BP >= 0 or T3_2500BP <= 0 or T4_2500BP >= 0 or T4_2500BP <= 0 or T5_2500BP >= 0 or T5_2500BP <= 0  [
      set Tprt (T3_2500BP + T4_2500BP + T5_2500BP) / 3] [set Tprt -9999]; moyenne des T printannières
    ifelse T6_2500BP >= 0 or  T6_2500BP <= 0 or T7_2500BP >= 0 or T7_2500BP <= 0 or T8_2500BP >= 0 or T8_2500BP <= 0  [
      set Tete (T6_2500BP + T7_2500BP + T8_2500BP) / 3] [set Tete -9999]; moyenne des T estivales
    ifelse T9_2500BP >= 0 or T9_2500BP <= 0 or T10_2500BP >= 0 or T10_2500BP <= 0 or T11_2500BP >= 0 or T11_2500BP <= 0 [
      set Taut (T9_2500BP + T10_2500BP + T11_2500BP) / 3] [set Taut -9999]; moyenne des T automnales
    ifelse P12_2500BP >= 0 or P1_2500BP >= 0 or P2_2500BP >= 0 [
      set Phiv P12_2500BP + P1_2500BP + P2_2500BP] [set Phiv -9999]; cumul des P hivernales
    ifelse P3_2500BP >= 0 or P4_2500BP >= 0 or P5_2500BP >= 0 [
      set Pprt P3_2500BP + P4_2500BP + P5_2500BP] [set Pprt -9999]; cumul des P printannières
    ifelse P6_2500BP >= 0 or P7_2500BP >= 0 or P8_2500BP >= 0 [
      set Pete P6_2500BP + P7_2500BP + P8_2500BP] [set Pete -9999]; cumul des P estivales
    ifelse P9_2500BP >= 0 or P10_2500BP >= 0 or P11_2500BP >= 0 [
      set Paut P9_2500BP + P10_2500BP + P11_2500BP] [set Paut -9999]; cumul des P automnales
  ]
end

to compute-climatic-data-2400BP
   ask patches [
    ifelse T12_2400BP >= 0 or T12_2400BP <= 0 or T1_2400BP >= 0 or T1_2400BP <= 0 or T2_2400BP >= 0 or T2_2400BP <= 0 [
      set Thiv (T12_2400BP + T1_2400BP + T2_2400BP) / 3] [set Thiv -9999]; moyenne des T hivernales
    ifelse T3_2400BP >= 0 or T3_2400BP <= 0 or T4_2400BP >= 0 or T4_2400BP <= 0 or T5_2400BP >= 0 or T5_2400BP <= 0  [
      set Tprt (T3_2400BP + T4_2400BP + T5_2400BP) / 3] [set Tprt -9999]; moyenne des T printannières
    ifelse T6_2400BP >= 0 or  T6_2400BP <= 0 or T7_2400BP >= 0 or T7_2400BP <= 0 or T8_2400BP >= 0 or T8_2400BP <= 0  [
      set Tete (T6_2400BP + T7_2400BP + T8_2400BP) / 3] [set Tete -9999]; moyenne des T estivales
    ifelse T9_2400BP >= 0 or T9_2400BP <= 0 or T10_2400BP >= 0 or T10_2400BP <= 0 or T11_2400BP >= 0 or T11_2400BP <= 0 [
      set Taut (T9_2400BP + T10_2400BP + T11_2400BP) / 3] [set Taut -9999]; moyenne des T automnales
    ifelse P12_2400BP >= 0 or P1_2400BP >= 0 or P2_2400BP >= 0 [
      set Phiv P12_2400BP + P1_2400BP + P2_2400BP] [set Phiv -9999]; cumul des P hivernales
    ifelse P3_2400BP >= 0 or P4_2400BP >= 0 or P5_2400BP >= 0 [
      set Pprt P3_2400BP + P4_2400BP + P5_2400BP] [set Pprt -9999]; cumul des P printannières
    ifelse P6_2400BP >= 0 or P7_2400BP >= 0 or P8_2400BP >= 0 [
      set Pete P6_2400BP + P7_2400BP + P8_2400BP] [set Pete -9999]; cumul des P estivales
    ifelse P9_2400BP >= 0 or P10_2400BP >= 0 or P11_2400BP >= 0 [
      set Paut P9_2400BP + P10_2400BP + P11_2400BP] [set Paut -9999]; cumul des P automnales
  ]
end

to compute-climatic-data-2300BP
   ask patches [
    ifelse T12_2300BP >= 0 or T12_2300BP <= 0 or T1_2300BP >= 0 or T1_2300BP <= 0 or T2_2300BP >= 0 or T2_2300BP <= 0 [
      set Thiv (T12_2300BP + T1_2300BP + T2_2300BP) / 3] [set Thiv -9999]; moyenne des T hivernales
    ifelse T3_2300BP >= 0 or T3_2300BP <= 0 or T4_2300BP >= 0 or T4_2300BP <= 0 or T5_2300BP >= 0 or T5_2300BP <= 0  [
      set Tprt (T3_2300BP + T4_2300BP + T5_2300BP) / 3] [set Tprt -9999]; moyenne des T printannières
    ifelse T6_2300BP >= 0 or  T6_2300BP <= 0 or T7_2300BP >= 0 or T7_2300BP <= 0 or T8_2300BP >= 0 or T8_2300BP <= 0  [
      set Tete (T6_2300BP + T7_2300BP + T8_2300BP) / 3] [set Tete -9999]; moyenne des T estivales
    ifelse T9_2300BP >= 0 or T9_2300BP <= 0 or T10_2300BP >= 0 or T10_2300BP <= 0 or T11_2300BP >= 0 or T11_2300BP <= 0 [
      set Taut (T9_2300BP + T10_2300BP + T11_2300BP) / 3] [set Taut -9999]; moyenne des T automnales
    ifelse P12_2300BP >= 0 or P1_2300BP >= 0 or P2_2300BP >= 0 [
      set Phiv P12_2300BP + P1_2300BP + P2_2300BP] [set Phiv -9999]; cumul des P hivernales
    ifelse P3_2300BP >= 0 or P4_2300BP >= 0 or P5_2300BP >= 0 [
      set Pprt P3_2300BP + P4_2300BP + P5_2300BP] [set Pprt -9999]; cumul des P printannières
    ifelse P6_2300BP >= 0 or P7_2300BP >= 0 or P8_2300BP >= 0 [
      set Pete P6_2300BP + P7_2300BP + P8_2300BP] [set Pete -9999]; cumul des P estivales
    ifelse P9_2300BP >= 0 or P10_2300BP >= 0 or P11_2300BP >= 0 [
      set Paut P9_2300BP + P10_2300BP + P11_2300BP] [set Paut -9999]; cumul des P automnales
  ]
end

to compute-climatic-data-2200BP
   ask patches [
    ifelse T12_2200BP >= 0 or T12_2200BP <= 0 or T1_2200BP >= 0 or T1_2200BP <= 0 or T2_2200BP >= 0 or T2_2200BP <= 0 [
      set Thiv (T12_2200BP + T1_2200BP + T2_2200BP) / 3] [set Thiv -9999]; moyenne des T hivernales
    ifelse T3_2200BP >= 0 or T3_2200BP <= 0 or T4_2200BP >= 0 or T4_2200BP <= 0 or T5_2200BP >= 0 or T5_2200BP <= 0  [
      set Tprt (T3_2200BP + T4_2200BP + T5_2200BP) / 3] [set Tprt -9999]; moyenne des T printannières
    ifelse T6_2200BP >= 0 or  T6_2200BP <= 0 or T7_2200BP >= 0 or T7_2200BP <= 0 or T8_2200BP >= 0 or T8_2200BP <= 0  [
      set Tete (T6_2200BP + T7_2200BP + T8_2200BP) / 3] [set Tete -9999]; moyenne des T estivales
    ifelse T9_2200BP >= 0 or T9_2200BP <= 0 or T10_2200BP >= 0 or T10_2200BP <= 0 or T11_2200BP >= 0 or T11_2200BP <= 0 [
      set Taut (T9_2200BP + T10_2200BP + T11_2200BP) / 3] [set Taut -9999]; moyenne des T automnales
    ifelse P12_2200BP >= 0 or P1_2200BP >= 0 or P2_2200BP >= 0 [
      set Phiv P12_2200BP + P1_2200BP + P2_2200BP] [set Phiv -9999]; cumul des P hivernales
    ifelse P3_2200BP >= 0 or P4_2200BP >= 0 or P5_2200BP >= 0 [
      set Pprt P3_2200BP + P4_2200BP + P5_2200BP] [set Pprt -9999]; cumul des P printannières
    ifelse P6_2200BP >= 0 or P7_2200BP >= 0 or P8_2200BP >= 0 [
      set Pete P6_2200BP + P7_2200BP + P8_2200BP] [set Pete -9999]; cumul des P estivales
    ifelse P9_2200BP >= 0 or P10_2200BP >= 0 or P11_2200BP >= 0 [
      set Paut P9_2200BP + P10_2200BP + P11_2200BP] [set Paut -9999]; cumul des P automnales
  ]
end

to compute-climatic-data-2100BP
   ask patches [
    ifelse T12_2100BP >= 0 or T12_2100BP <= 0 or T1_2100BP >= 0 or T1_2100BP <= 0 or T2_2100BP >= 0 or T2_2100BP <= 0 [
      set Thiv (T12_2100BP + T1_2100BP + T2_2100BP) / 3] [set Thiv -9999]; moyenne des T hivernales
    ifelse T3_2100BP >= 0 or T3_2100BP <= 0 or T4_2100BP >= 0 or T4_2100BP <= 0 or T5_2100BP >= 0 or T5_2100BP <= 0  [
      set Tprt (T3_2100BP + T4_2100BP + T5_2100BP) / 3] [set Tprt -9999]; moyenne des T printannières
    ifelse T6_2100BP >= 0 or  T6_2100BP <= 0 or T7_2100BP >= 0 or T7_2100BP <= 0 or T8_2100BP >= 0 or T8_2100BP <= 0  [
      set Tete (T6_2100BP + T7_2100BP + T8_2100BP) / 3] [set Tete -9999]; moyenne des T estivales
    ifelse T9_2100BP >= 0 or T9_2100BP <= 0 or T10_2100BP >= 0 or T10_2100BP <= 0 or T11_2100BP >= 0 or T11_2100BP <= 0 [
      set Taut (T9_2100BP + T10_2100BP + T11_2100BP) / 3] [set Taut -9999]; moyenne des T automnales
    ifelse P12_2100BP >= 0 or P1_2100BP >= 0 or P2_2100BP >= 0 [
      set Phiv P12_2100BP + P1_2100BP + P2_2100BP] [set Phiv -9999]; cumul des P hivernales
    ifelse P3_2100BP >= 0 or P4_2100BP >= 0 or P5_2100BP >= 0 [
      set Pprt P3_2100BP + P4_2100BP + P5_2100BP] [set Pprt -9999]; cumul des P printannières
    ifelse P6_2100BP >= 0 or P7_2100BP >= 0 or P8_2100BP >= 0 [
      set Pete P6_2100BP + P7_2100BP + P8_2100BP] [set Pete -9999]; cumul des P estivales
    ifelse P9_2100BP >= 0 or P10_2100BP >= 0 or P11_2100BP >= 0 [
      set Paut P9_2100BP + P10_2100BP + P11_2100BP] [set Paut -9999]; cumul des P automnales
  ]
end

to compute-climatic-data-2000BP
   ask patches [
    ifelse T12_2000BP >= 0 or T12_2000BP <= 0 or T1_2000BP >= 0 or T1_2000BP <= 0 or T2_2000BP >= 0 or T2_2000BP <= 0 [
      set Thiv (T12_2000BP + T1_2000BP + T2_2000BP) / 3] [set Thiv -9999]; moyenne des T hivernales
    ifelse T3_2000BP >= 0 or T3_2000BP <= 0 or T4_2000BP >= 0 or T4_2000BP <= 0 or T5_2000BP >= 0 or T5_2000BP <= 0 [
      set Tprt (T3_2000BP + T4_2000BP + T5_2000BP) / 3] [set Tprt -9999]; moyenne des T printannières
    ifelse T6_2000BP >= 0 or T7_2000BP >= 0 or T8_2000BP >= 0 [
      set Tete (T6_2000BP + T7_2000BP + T8_2000BP) / 3] [set Tete -9999]; moyenne des T estivales
    ifelse T9_2000BP >= 0 or T10_2000BP >= 0 or T11_2000BP >= 0 [
      set Taut (T9_2000BP + T10_2000BP + T11_2000BP) / 3] [set Taut -9999]; moyenne des T automnales
    ifelse P12_2000BP >= 0 or P1_2000BP >= 0 or P2_2000BP >= 0 [
      set Phiv P12_2000BP + P1_2000BP + P2_2000BP] [set Phiv -9999]; cumul des P hivernales
    ifelse P3_2000BP >= 0 or P4_2000BP >= 0 or P5_2000BP >= 0 [
      set Pprt P3_2000BP + P4_2000BP + P5_2000BP] [set Pprt -9999]; cumul des P printannières
    ifelse P6_2000BP >= 0 or P7_2000BP >= 0 or P8_2000BP >= 0 [
      set Pete P6_2000BP + P7_2000BP + P8_2000BP] [set Pete -9999]; cumul des P estivales
    ifelse P9_2000BP >= 0 or P10_2000BP >= 0 or P11_2000BP >= 0 [
      set Paut P9_2000BP + P10_2000BP + P11_2000BP] [set Paut -9999]; cumul des P automnales
  ]
end

to compute-climatic-data-1900BP
   ask patches [
    ifelse T12_1900BP >= 0 or T12_1900BP <= 0 or T1_1900BP >= 0 or T1_1900BP <= 0 or T2_1900BP >= 0 or T2_1900BP <= 0 [
      set Thiv (T12_1900BP + T1_1900BP + T2_1900BP) / 3] [set Thiv -9999]; moyenne des T hivernales
    ifelse T3_1900BP >= 0 or T3_1900BP <= 0 or T4_1900BP >= 0 or T4_1900BP <= 0 or T5_1900BP >= 0 or T5_1900BP <= 0 [
      set Tprt (T3_1900BP + T4_1900BP + T5_1900BP) / 3] [set Tprt -9999]; moyenne des T printannières
    ifelse T6_1900BP >= 0 or T7_1900BP >= 0 or T8_1900BP >= 0 [
      set Tete (T6_1900BP + T7_1900BP + T8_1900BP) / 3] [set Tete -9999]; moyenne des T estivales
    ifelse T9_1900BP >= 0 or T10_1900BP >= 0 or T11_1900BP >= 0 [
      set Taut (T9_1900BP + T10_1900BP + T11_1900BP) / 3] [set Taut -9999]; moyenne des T automnales
    ifelse P12_1900BP >= 0 or P1_1900BP >= 0 or P2_1900BP >= 0 [
      set Phiv P12_1900BP + P1_1900BP + P2_1900BP] [set Phiv -9999]; cumul des P hivernales
    ifelse P3_1900BP >= 0 or P4_1900BP >= 0 or P5_1900BP >= 0 [
      set Pprt P3_1900BP + P4_1900BP + P5_1900BP] [set Pprt -9999]; cumul des P printannières
    ifelse P6_1900BP >= 0 or P7_1900BP >= 0 or P8_1900BP >= 0 [
      set Pete P6_1900BP + P7_1900BP + P8_1900BP] [set Pete -9999]; cumul des P estivales
    ifelse P9_1900BP >= 0 or P10_1900BP >= 0 or P11_1900BP >= 0 [
      set Paut P9_1900BP + P10_1900BP + P11_1900BP] [set Paut -9999]; cumul des P automnales
  ]
end

to compute-climatic-data-1800BP
   ask patches [
    ifelse T12_1800BP >= 0 or T12_1800BP <= 0 or T1_1800BP >= 0 or T1_1800BP <= 0 or T2_1800BP >= 0 or T2_1800BP <= 0 [
      set Thiv (T12_1800BP + T1_1800BP + T2_1800BP) / 3] [set Thiv -9999]; moyenne des T hivernales
    ifelse T3_1800BP >= 0 or T3_1800BP <= 0 or T4_1800BP >= 0 or T4_1800BP <= 0 or T5_1800BP >= 0 or T5_1800BP <= 0 [
      set Tprt (T3_1800BP + T4_1800BP + T5_1800BP) / 3] [set Tprt -9999]; moyenne des T printannières
    ifelse T6_1800BP >= 0 or T7_1800BP >= 0 or T8_1800BP >= 0 [
      set Tete (T6_1800BP + T7_1800BP + T8_1800BP) / 3] [set Tete -9999]; moyenne des T estivales
    ifelse T9_1800BP >= 0 or T10_1800BP >= 0 or T11_1800BP >= 0 [
      set Taut (T9_1800BP + T10_1800BP + T11_1800BP) / 3] [set Taut -9999]; moyenne des T automnales
    ifelse P12_1800BP >= 0 or P1_1800BP >= 0 or P2_1800BP >= 0 [
      set Phiv P12_1800BP + P1_1800BP + P2_1800BP] [set Phiv -9999]; cumul des P hivernales
    ifelse P3_1800BP >= 0 or P4_1800BP >= 0 or P5_1800BP >= 0 [
      set Pprt P3_1800BP + P4_1800BP + P5_1800BP] [set Pprt -9999]; cumul des P printannières
    ifelse P6_1800BP >= 0 or P7_1800BP >= 0 or P8_1800BP >= 0 [
      set Pete P6_1800BP + P7_1800BP + P8_1800BP] [set Pete -9999]; cumul des P estivales
    ifelse P9_1800BP >= 0 or P10_1800BP >= 0 or P11_1800BP >= 0 [
      set Paut P9_1800BP + P10_1800BP + P11_1800BP] [set Paut -9999]; cumul des P automnales
  ]
end

to compute-climatic-data-1700BP
   ask patches [
    ifelse T12_1700BP >= 0 or T12_1700BP <= 0 or T1_1700BP >= 0 or T1_1700BP <= 0 or T2_1700BP >= 0 or T2_1700BP <= 0 [
      set Thiv (T12_1700BP + T1_1700BP + T2_1700BP) / 3] [set Thiv -9999]; moyenne des T hivernales
    ifelse T3_1700BP >= 0 or T3_1700BP <= 0 or T4_1700BP >= 0 or T4_1700BP <= 0 or T5_1700BP >= 0 or T5_1700BP <= 0 [
      set Tprt (T3_1700BP + T4_1700BP + T5_1700BP) / 3] [set Tprt -9999]; moyenne des T printannières
    ifelse T6_1700BP >= 0 or T7_1700BP >= 0 or T8_1700BP >= 0 [
      set Tete (T6_1700BP + T7_1700BP + T8_1700BP) / 3] [set Tete -9999]; moyenne des T estivales
    ifelse T9_1700BP >= 0 or T10_1700BP >= 0 or T11_1700BP >= 0 [
      set Taut (T9_1700BP + T10_1700BP + T11_1700BP) / 3] [set Taut -9999]; moyenne des T automnales
    ifelse P12_1700BP >= 0 or P1_1700BP >= 0 or P2_1700BP >= 0 [
      set Phiv P12_1700BP + P1_1700BP + P2_1700BP] [set Phiv -9999]; cumul des P hivernales
    ifelse P3_1700BP >= 0 or P4_1700BP >= 0 or P5_1700BP >= 0 [
      set Pprt P3_1700BP + P4_1700BP + P5_1700BP] [set Pprt -9999]; cumul des P printannières
    ifelse P6_1700BP >= 0 or P7_1700BP >= 0 or P8_1700BP >= 0 [
      set Pete P6_1700BP + P7_1700BP + P8_1700BP] [set Pete -9999]; cumul des P estivales
    ifelse P9_1700BP >= 0 or P10_1700BP >= 0 or P11_1700BP >= 0 [
      set Paut P9_1700BP + P10_1700BP + P11_1700BP] [set Paut -9999]; cumul des P automnales
  ]
end

to compute-climatic-data-1600BP
   ask patches [
    ifelse T12_1600BP >= 0 or T12_1600BP <= 0 or T1_1600BP >= 0 or T1_1600BP <= 0 or T2_1600BP >= 0 or T2_1600BP <= 0 [
      set Thiv (T12_1600BP + T1_1600BP + T2_1600BP) / 3] [set Thiv -9999]; moyenne des T hivernales
    ifelse T3_1600BP >= 0 or T3_1600BP <= 0 or T4_1600BP >= 0 or T4_1600BP <= 0 or T5_1600BP >= 0 or T5_1600BP <= 0 [
      set Tprt (T3_1600BP + T4_1600BP + T5_1600BP) / 3] [set Tprt -9999]; moyenne des T printannières
    ifelse T6_1600BP >= 0 or T7_1600BP >= 0 or T8_1600BP >= 0 [
      set Tete (T6_1600BP + T7_1600BP + T8_1600BP) / 3] [set Tete -9999]; moyenne des T estivales
    ifelse T9_1600BP >= 0 or T10_1600BP >= 0 or T11_1600BP >= 0 [
      set Taut (T9_1600BP + T10_1600BP + T11_1600BP) / 3] [set Taut -9999]; moyenne des T automnales
    ifelse P12_1600BP >= 0 or P1_1600BP >= 0 or P2_1600BP >= 0 [
      set Phiv P12_1600BP + P1_1600BP + P2_1600BP] [set Phiv -9999]; cumul des P hivernales
    ifelse P3_1600BP >= 0 or P4_1600BP >= 0 or P5_1600BP >= 0 [
      set Pprt P3_1600BP + P4_1600BP + P5_1600BP] [set Pprt -9999]; cumul des P printannières
    ifelse P6_1600BP >= 0 or P7_1600BP >= 0 or P8_1600BP >= 0 [
      set Pete P6_1600BP + P7_1600BP + P8_1600BP] [set Pete -9999]; cumul des P estivales
    ifelse P9_1600BP >= 0 or P10_1600BP >= 0 or P11_1600BP >= 0 [
      set Paut P9_1600BP + P10_1600BP + P11_1600BP] [set Paut -9999]; cumul des P automnales
  ]
end

to compute-climatic-data-1500BP
   ask patches [
    ifelse T12_1500BP >= 0 or T12_1500BP <= 0 or T1_1500BP >= 0 or T1_1500BP <= 0 or T2_1500BP >= 0 or T2_1500BP <= 0 [
      set Thiv (T12_1500BP + T1_1500BP + T2_1500BP) / 3] [set Thiv -9999]; moyenne des T hivernales
    ifelse T3_1500BP >= 0 or T3_1500BP <= 0 or T4_1500BP >= 0 or T4_1500BP <= 0 or T5_1500BP >= 0 or T5_1500BP <= 0 [
      set Tprt (T3_1500BP + T4_1500BP + T5_1500BP) / 3] [set Tprt -9999]; moyenne des T printannières
    ifelse T6_1500BP >= 0 or T7_1500BP >= 0 or T8_1500BP >= 0 [
      set Tete (T6_1500BP + T7_1500BP + T8_1500BP) / 3] [set Tete -9999]; moyenne des T estivales
    ifelse T9_1500BP >= 0 or T10_1500BP >= 0 or T11_1500BP >= 0 [
      set Taut (T9_1500BP + T10_1500BP + T11_1500BP) / 3] [set Taut -9999]; moyenne des T automnales
    ifelse P12_1500BP >= 0 or P1_1500BP >= 0 or P2_1500BP >= 0 [
      set Phiv P12_1500BP + P1_1500BP + P2_1500BP] [set Phiv -9999]; cumul des P hivernales
    ifelse P3_1500BP >= 0 or P4_1500BP >= 0 or P5_1500BP >= 0 [
      set Pprt P3_1500BP + P4_1500BP + P5_1500BP] [set Pprt -9999]; cumul des P printannières
    ifelse P6_1500BP >= 0 or P7_1500BP >= 0 or P8_1500BP >= 0 [
      set Pete P6_1500BP + P7_1500BP + P8_1500BP] [set Pete -9999]; cumul des P estivales
    ifelse P9_1500BP >= 0 or P10_1500BP >= 0 or P11_1500BP >= 0 [
      set Paut P9_1500BP + P10_1500BP + P11_1500BP] [set Paut -9999]; cumul des P automnales
  ]
end

to compute-climatic-data-1400BP
   ask patches [
    ifelse T12_1400BP >= 0 or T12_1400BP <= 0 or T1_1400BP >= 0 or T1_1400BP <= 0 or T2_1400BP >= 0 or T2_1400BP <= 0 [
      set Thiv (T12_1400BP + T1_1400BP + T2_1400BP) / 3] [set Thiv -9999]; moyenne des T hivernales
    ifelse T3_1400BP >= 0 or T3_1400BP <= 0 or T4_1400BP >= 0 or T4_1400BP <= 0 or T5_1400BP >= 0 or T5_1400BP <= 0 [
      set Tprt (T3_1400BP + T4_1400BP + T5_1400BP) / 3] [set Tprt -9999]; moyenne des T printannières
    ifelse T6_1400BP >= 0 or T7_1400BP >= 0 or T8_1400BP >= 0 [
      set Tete (T6_1400BP + T7_1400BP + T8_1400BP) / 3] [set Tete -9999]; moyenne des T estivales
    ifelse T9_1400BP >= 0 or T10_1400BP >= 0 or T11_1400BP >= 0 [
      set Taut (T9_1400BP + T10_1400BP + T11_1400BP) / 3] [set Taut -9999]; moyenne des T automnales
    ifelse P12_1400BP >= 0 or P1_1400BP >= 0 or P2_1400BP >= 0 [
      set Phiv P12_1400BP + P1_1400BP + P2_1400BP] [set Phiv -9999]; cumul des P hivernales
    ifelse P3_1400BP >= 0 or P4_1400BP >= 0 or P5_1400BP >= 0 [
      set Pprt P3_1400BP + P4_1400BP + P5_1400BP] [set Pprt -9999]; cumul des P printannières
    ifelse P6_1400BP >= 0 or P7_1400BP >= 0 or P8_1400BP >= 0 [
      set Pete P6_1400BP + P7_1400BP + P8_1400BP] [set Pete -9999]; cumul des P estivales
    ifelse P9_1400BP >= 0 or P10_1400BP >= 0 or P11_1400BP >= 0 [
      set Paut P9_1400BP + P10_1400BP + P11_1400BP] [set Paut -9999]; cumul des P automnales
  ]
end

to compute-climatic-data-1300BP
   ask patches [
    ifelse T12_1300BP >= 0 or T12_1300BP <= 0 or T1_1300BP >= 0 or T1_1300BP <= 0 or T2_1300BP >= 0 or T2_1300BP <= 0 [
      set Thiv (T12_1300BP + T1_1300BP + T2_1300BP) / 3] [set Thiv -9999]; moyenne des T hivernales
    ifelse T3_1300BP >= 0 or T3_1300BP <= 0 or T4_1300BP >= 0 or T4_1300BP <= 0 or T5_1300BP >= 0 or T5_1300BP <= 0 [
      set Tprt (T3_1300BP + T4_1300BP + T5_1300BP) / 3] [set Tprt -9999]; moyenne des T printannières
    ifelse T6_1300BP >= 0 or T7_1300BP >= 0 or T8_1300BP >= 0 [
      set Tete (T6_1300BP + T7_1300BP + T8_1300BP) / 3] [set Tete -9999]; moyenne des T estivales
    ifelse T9_1300BP >= 0 or T10_1300BP >= 0 or T11_1300BP >= 0 [
      set Taut (T9_1300BP + T10_1300BP + T11_1300BP) / 3] [set Taut -9999]; moyenne des T automnales
    ifelse P12_1300BP >= 0 or P1_1300BP >= 0 or P2_1300BP >= 0 [
      set Phiv P12_1300BP + P1_1300BP + P2_1300BP] [set Phiv -9999]; cumul des P hivernales
    ifelse P3_1300BP >= 0 or P4_1300BP >= 0 or P5_1300BP >= 0 [
      set Pprt P3_1300BP + P4_1300BP + P5_1300BP] [set Pprt -9999]; cumul des P printannières
    ifelse P6_1300BP >= 0 or P7_1300BP >= 0 or P8_1300BP >= 0 [
      set Pete P6_1300BP + P7_1300BP + P8_1300BP] [set Pete -9999]; cumul des P estivales
    ifelse P9_1300BP >= 0 or P10_1300BP >= 0 or P11_1300BP >= 0 [
      set Paut P9_1300BP + P10_1300BP + P11_1300BP] [set Paut -9999]; cumul des P automnales
  ]
end

to emulate-LPJML_var
  ask patches [
      set WR 0.3452 + 0.033 * Thiv_var + 0.0072 * Tprt_var + 0.0467 * Tete_var - 0.0523 * Taut_var +  0.0016 * Pprt_var + 1e-04 * Pete_var - 4e-04 * Paut_var; rendement blé pluvial (wheath rainfed)
     if WR = 0.3452 or WR < 0 [set WR 0]
      set WI 0.4926 + 0.0135 * Thiv_var - 0.0081 * Tprt_var + 0.0348 * Tete_var - 0.0074 * Taut_var - 1e-04 * Phiv_var + 7e-04 * Pprt_var - 4e-04 * Pete_var + 0 * Paut_var ; blé irrigué (t/ha)
    if WI = 0.4926 or WI < 0 [set WI 0]
      set GR -34.2138 - 2.64 * Thiv_var + 2.2907 * Tprt_var - 2.4294 * Tete_var + 5.3971 * Taut_var - 0.0033 * Phiv_var + 0.04 * Pprt_var + 0.0631 * Pete_var - 0.0184 * Paut_var; rendement vigne pluviale (hl/ha)
    if GR = -34.2138 or GR < 0 [set GR 0]
      set GI -45.0426 + 0.45 * Thiv_var + 2.0927 * Tprt_var + 1.9081 * Tete_var + 1.7607 * Taut_var - 5e-04 * Phiv_var - 0.0368 * Pprt_var - 0.0131 * Pete_var + 0.0341 * Paut_var; calcule le rendement pour la vigne irriguée
    if GI = -45.0426 or GI < 0 [set GI 0]
      set OR_ -0.0553 + 0.053 * Thiv_var - 0.0776 * Tprt_var - 0.0099 * Tete_var + 0.0445 * Taut_var - 5e-04 * Phiv_var + 0.0016 * Pprt_var + 0.0026 * Pete_var + 5e-04 * Paut_var; calcule le rendement pour les olives pluviales
    if OR_ = -0.0553 or OR_ < 0 or Thiv_var < 3 [set OR_ 0]
      set OI 3.863 + 0.5942 * Thiv_var - 0.4147 * Tprt_var + 0.4527 * Tete_var - 0.6695 * Taut_var + 9e-04 * Phiv_var - 0.0053 * Pprt_var - 7e-04 * Pete_var + 0.0025 * Paut_var ; rendement olive irriguée (t/ha)
    if OI = 3.863 or OI < 0 [set OI 0]
      set PR 0.7778 - 0.0741 * Thiv_var + 0.189 * Tprt_var - 0.1578 * Tete_var + 0.059 * Taut_var - 2e-04 * Phiv_var + 0.0014 * Pprt_var + 0.0016 * Pete_var - 4e-04 * Paut_var ; pois pluvial (t/ha)
    if PR = 0.7778 or PR < 0 [set PR 0]
      set PI_ 0.6731 - 0.0891 * Thiv_var + 0.1968 * Tprt_var - 0.0961 * Tete_var + 0.0135 * Taut_var + 0 * Phiv_var + 0.0019 * Pprt_var - 1e-04 * Pete_var - 7e-04 * Paut_var; pois irrigué (t/ha)
    if PI_ = 0.6731 or PI_ < 0 [set PI_ -1]
  ]
end

;to emulate-LPJML_var; mis à jour le 15/12/2020 avec de nouveaux calculs LPJmL pour GI, GR, OI, OR
 ;ask patches [
   ;set WR 0.3452 + 0.033 * Thiv_var + 0.0072 * Tprt_var + 0.0467 * Tete_var - 0.0523 * Taut_var +  0.0016 * Pprt_var + 1e-04 * Pete_var - 4e-04 * Paut_var; rendement blé pluvial (wheath rainfed)
     ;if WR = 0.3452 or WR < 0 [set WR 0]
    ;set WI 0.4926 + 0.0135 * Thiv_var - 0.0081 * Tprt_var + 0.0348 * Tete_var - 0.0074 * Taut_var - 1e-04 * Phiv_var + 7e-04 * Pprt_var - 4e-04 * Pete_var + 0 * Paut_var ; blé irrigué (t/ha)
    ;if WI = 0.4926 or WI < 0 [set WI 0]
    ;set GR 2.27342 - 0.09553 * Thiv_var + 3.33003 * Tprt_var - 1.89007 + Tete_var + 0.30906 * Taut_var + 0.00672 * Phiv_var + 0.00189 * Pprt_var + 0.04753 * Pete_var - 0.0229 * Paut_var; rendement vigne pluviale (hl/ha)
     ;if GR = 2.27342 or GR < 0 [set GR 0]
    ;set GI -2.5062 + 3.0134 * Thiv_var + 5.138 + 2.01973 * Tprt_var - 4.788 * Tete_var + 0.023 * Taut_var - 0.07884 * Phiv_var - 0.02488 * Pprt_var + 0.01668 * Pete_var + 0.97531 * Paut_var; rendement vigne irriguée
    ;if GI = -2.5062 or GI < 0 [set GI 0]
    ;set OR_ 1.29821 + 0.08774 * Thiv_var + 0.21318 * Tprt_var - 0.07401 * Tete_var - 0.18639 * Taut_var + 0.00096 * Phiv_var - 0.00027 * Pprt_var + 0.00337 * Pete_var - 0.00151 * Paut_var; rendement olives pluviales
    ;if OR_ = 1.29821 or OR_ < 0 or Thiv_var < 3 [set OR_ 0]
    ;set OI 5.94611 + 0.75159 * Thiv_var  - 0.17431 * Tprt_var + 0.50021 * Tete_var - 1.09134 * Taut_var + 0.00292 * Phiv_var - 0.00904 * Pprt_var - 0.00049 * Pete_var + 0.00041 * Paut_var; rendement olive irriguée (t/ha)
     ;if OI = 5.94611 or OI < 0 [set OI 0]
    ;set PR 0.7778 - 0.0741 * Thiv_var + 0.189 * Tprt_var - 0.1578 * Tete_var + 0.059 * Taut_var - 2e-04 * Phiv_var + 0.0014 * Pprt_var + 0.0016 * Pete_var - 4e-04 * Paut_var ; pois pluvial (t/ha)
     ;if PR = 0.7778 or PR < 0 [set PR 0]
    ;set PI_ 0.6731 - 0.0891 * Thiv_var + 0.1968 * Tprt_var - 0.0961 * Tete_var + 0.0135 * Taut_var + 0 * Phiv_var + 0.0019 * Pprt_var - 1e-04 * Pete_var - 7e-04 * Paut_var; pois irrigué (t/ha)
     ;if PI_ = 0.6731 or PI_ < 0 [set PI_ -1]
  ;]
;end

;to color-patches
  ;ask patches [
  ;if Culture = "None" [set pcolor white]
  ;if Culture = "Wheat rainfed" [set pcolor scale-color yellow WR 1.5 0]
  ;if Culture = "Wheat irrigated" [set pcolor scale-color yellow WI max [WI] of patches 0]
  ;if GR_2500_ <= 0 or GR_2500_ >= 0 and Culture = "Grapes rainfed" and Century = "2500 BP" [set pcolor scale-color red GR_2500_ 0 10]
  ;if Culture = "Grapes irrigated" [set pcolor scale-color red GI 60 0]
  ;if Culture = "Olives rainfed" [set pcolor scale-color green OR_ max [OR_] of patches 0]
  ;if Culture = "Olives irrigated" [set pcolor scale-color green OI 5 0]; pb avec les valeurs max de OI
  ;if Culture = "Peas rainfed" [set pcolor scale-color blue PR max [PR] of patches 0]
  ;if Culture = "Peas irrigated" [set pcolor scale-color blue PI_ max [PI_] of patches 0]
  ;if WR < 0 or WI < 0 or GR < 0 or GI < 0 or  OR_ < 0 or OI < 0 or PR < 0 or PI_ < 0 and Pycor < 19 [set pcolor blue]
  ;if WR < 0 or WI < 0 or GR < 0 or GI < 0 or  OR_ < 0 or OI < 0 or PR < 0 or PI_ < 0 and Pxcor > 54 and Pycor > 19 [set pcolor grey]
  ;if WR < 0 or WI < 0 or GR < 0 or GI < 0 or  OR_ < 0 or OI < 0 or PR < 0 or PI_ < 0 and Pxcor < 7 and Pycor < 12 [set pcolor grey]
  ;]
;end

to color-patches
  ask patches [
    set pcolor 9
    ask patches gis:intersecting Narbonnaise [set pcolor white]
  ;if Culture = "None" [set pcolor white]
  ;if Culture = "Wheat rainfed" [set pcolor scale-color yellow WR 1.5 0]
  ;if Culture = "Wheat irrigated" [set pcolor scale-color yellow WI max [WI] of patches 0]

  if Culture = "Grapes rainfed" and Century = "2500 BP" and GR_2500_ >= 0  [set pcolor scale-color red GR_2500_ 24 0]
  if Culture = "Grapes rainfed" and Century = "2400 BP" and GR_2400_ >= 0  [set pcolor scale-color red GR_2400_ 24 0]
  if Culture = "Grapes rainfed" and Century = "2300 BP" and GR_2500_ >= 0  [set pcolor scale-color red GR_2300_ 24 0]
  if Culture = "Grapes rainfed" and Century = "2200 BP" and GR_2400_ >= 0  [set pcolor scale-color red GR_2200_ 24 0]
  if Culture = "Grapes rainfed" and Century = "2100 BP" and GR_2500_ >= 0  [set pcolor scale-color red GR_2100_ 24 0]
  if Culture = "Grapes rainfed" and Century = "2000 BP" and GR_2400_ >= 0  [set pcolor scale-color red GR_2000_ 24 0]
  if Culture = "Grapes rainfed" and Century = "1900 BP" and GR_2500_ >= 0  [set pcolor scale-color red GR_1900_ 24 0]
  if Culture = "Grapes rainfed" and Century = "1800 BP" and GR_2400_ >= 0  [set pcolor scale-color red GR_1800_ 24 0]
  if Culture = "Grapes rainfed" and Century = "1700 BP" and GR_2500_ >= 0  [set pcolor scale-color red GR_1700_ 24 0]
  if Culture = "Grapes rainfed" and Century = "1600 BP" and GR_2400_ >= 0  [set pcolor scale-color red GR_1600_ 24 0]
  if Culture = "Grapes rainfed" and Century = "1500 BP" and GR_2500_ >= 0  [set pcolor scale-color red GR_1500_ 24 0]
  if Culture = "Grapes rainfed" and Century = "1400 BP" and GR_2400_ >= 0  [set pcolor scale-color red GR_1400_ 24 0]
  if Culture = "Grapes rainfed" and Century = "1300 BP" and GR_2400_ >= 0  [set pcolor scale-color red GR_1300_ 24 0]

  if Culture = "Olives rainfed" and Century = "2500 BP" and OR_2500_ >= 0  [set pcolor scale-color green OR_2500_ 2 0]
  if Culture = "Olives rainfed" and Century = "2400 BP" and OR_2400_ >= 0  [set pcolor scale-color green OR_2400_ 2 0]
  if Culture = "Olives rainfed" and Century = "2300 BP" and OR_2500_ >= 0  [set pcolor scale-color green OR_2300_ 2 0]
  if Culture = "Olives rainfed" and Century = "2200 BP" and OR_2400_ >= 0  [set pcolor scale-color green OR_2200_ 2 0]
  if Culture = "Olives rainfed" and Century = "2100 BP" and OR_2500_ >= 0  [set pcolor scale-color green OR_2100_ 2 0]
  if Culture = "Olives rainfed" and Century = "2000 BP" and OR_2400_ >= 0  [set pcolor scale-color green OR_2000_ 2 0]
  if Culture = "Olives rainfed" and Century = "1900 BP" and OR_2500_ >= 0  [set pcolor scale-color green OR_1900_ 2 0]
  if Culture = "Olives rainfed" and Century = "1800 BP" and OR_2400_ >= 0  [set pcolor scale-color green OR_1800_ 2 0]
  if Culture = "Olives rainfed" and Century = "1700 BP" and OR_2500_ >= 0  [set pcolor scale-color green OR_1700_ 2 0]
  if Culture = "Olives rainfed" and Century = "1600 BP" and OR_2400_ >= 0  [set pcolor scale-color green OR_1600_ 2 0]
  if Culture = "Olives rainfed" and Century = "1500 BP" and OR_2500_ >= 0  [set pcolor scale-color green OR_1500_ 2 0]
  if Culture = "Olives rainfed" and Century = "1400 BP" and OR_2400_ >= 0  [set pcolor scale-color green OR_1400_ 2 0]
  if Culture = "Olives rainfed" and Century = "1300 BP" and OR_2400_ >= 0  [set pcolor scale-color green OR_1300_ 2 0]

  ;if GR_2400_ <= 0 or GR_2400_ >= 0 and Culture = "Grapes rainfed" and Century = "2400 BP" [set pcolor scale-color red GR_2500_ 0 10]
  ;if Culture = "Grapes irrigated" [set pcolor scale-color red GI 60 0]
  ;if Culture = "Olives rainfed" [set pcolor scale-color green OR_ max [OR_] of patches 0]
  ;if Culture = "Olives irrigated" [set pcolor scale-color green OI 5 0]; pb avec les valeurs max de OI
  ;if Culture = "Peas rainfed" [set pcolor scale-color blue PR max [PR] of patches 0]
  ;if Culture = "Peas irrigated" [set pcolor scale-color blue PI_ max [PI_] of patches 0]
  if WR < 0 or WI < 0 or GR < 0 or GI < 0 or  OR_ < 0 or OI < 0 or PR < 0 or PI_ < 0 and Pycor < 19 [set pcolor blue]
  if WR < 0 or WI < 0 or GR < 0 or GI < 0 or  OR_ < 0 or OI < 0 or PR < 0 or PI_ < 0 and Pxcor > 54 and Pycor > 19 [set pcolor 9]
  if WR < 0 or WI < 0 or GR < 0 or GI < 0 or  OR_ < 0 or OI < 0 or PR < 0 or PI_ < 0 and Pxcor < 14 and Pycor < 3 [set pcolor 9]
  if Dis-archeo-olives? = TRUE [ask patches gis:intersecting Archeo_Olive [set pcolor 136]]
  if Dis-archeo-wine? = TRUE [ask patches gis:intersecting Archaeo_Wine [set pcolor pink]]
    ;ask patches gis:intersecting Dioceses [set pcolor white]
    ;ask patches gis:intersecting Olivier_area_Leveau [set pcolor 88]
  ]
end

;to color-patches2
  ;if LPJML_True = TRUE [
  ;ask patches [
      ;if WheatR_2500BP_LPJmL >= 0
     ;[set pcolor scale-color green WheatR_2500BP_LPJmL max [WheatR_2500BP_LPJmL] of patches 0]
    ;]
  ;]
;end

to create_var
ask patches [
  set Thiv_var Thiv + Thiv_ano
  set Tprt_var Tprt + Tprt_ano
  set Tete_var Tete + Tete_ano
  set Taut_var Taut + Taut_ano
  set Phiv_var Phiv + Phiv_ano
  set Pprt_var Pprt + Pprt_ano
  set Pete_var Pete + Pete_ano
  set Paut_var Paut + Paut_ano
  ]
end

;to setup-Farms-R
  ;ask patches [if WR > 0 [sprout-Farms 1]]
  ;ask patches gis:intersecting Narbonnaise [sprout-Farms 1]
  ;ask Farms [
    ;set shape "Square"
    ;set color yellow
    ;set size 0.5
    ;set cultivated-area 25; les fermes peuvent cultiver jusqu'à 6 ha maximum
    ;set harvest cultivated-area * WR; récolte (T) égale à la superficie cultivée * rendement en blé pluvial (WR)
    ;set people 6
    ;set Seed cultivated-area * 0.135; semer 5 modius de blé nu/jugère = 0.135t/ha
    ;set Surplus harvest - people * 0.2 - Seed; surplus égal à la récolte moins la consommation des exploitants (ici 0.2 tonnes/personne/an) - semence nécessaire pour l'année suivante
    ;set Surplus_Price Surplus * 59160 ;calculé sur la base du prix du blé dans l'édit de Dioclétien (1 modius = 100 deniers, soit 8.67l = 100 deniers, 6.76kg = 100 deniers (masse vol. du blé = 78kg/hl), 1kg=14.79 deniers, 1kg = 59,16 sesterces)
    ;set Distance_to_towns distance (min-one-of Towns [distance myself]) * 8.1; calcule la distance en patches jusqu'à la ville la plus proche (nombre de patche * 8.1 km)
    ;set Distance_cost Distance_to_towns * Surplus * 1000 * Transport_costs
    ;set Surplus_Price Surplus * 1000 / 6.7 * Wheat_price - Distance_cost ; (1 modius = 8.67l = 6.7 kg)
    ;set size 0.5
    ;set size Surplus_Price / 100000
    ;if any? Towns-on patch-here [set hidden? true];la ferme est cachée s'il existe une ville sur le patch (pour une meilleure lisibilité de la carte)
    ;ask Farms [if harvest < people * 0.3 [die]]
  ;]
;end

to setup-Farms-R
  ;ask patches [if WR > 0 [sprout-Farms 1]]
  ask patches gis:intersecting Narbonnaise [sprout-Farms 1]
  ask Farms [
    set shape "Square"
    set color yellow
    set cultivated-area 25
    set harvest cultivated-area * WR; récolte (T) égale à la superficie cultivée * rendement en blé pluvial (WR)
    set people cultivated-area / 2; 1 homme pour 2ha (Saserna)
    set Seed cultivated-area * 0.135; semer 5 modius de blé nu/jugère = 0.135t/ha
    set Surplus harvest - people * 0.2 - Seed; surplus égal à la récolte moins la consommation des exploitants (ici 0.2 tonnes/personne/an) - semence nécessaire pour l'année suivante
    ;set Surplus_Price Surplus * 59160 ;calculé sur la base du prix du blé dans l'édit de Dioclétien (1 modius = 100 deniers, soit 8.67l = 100 deniers, 6.76kg = 100 deniers (masse vol. du blé = 78kg/hl), 1kg=14.79 deniers, 1kg = 59,16 sesterces)
    set Distance_to_towns distance (min-one-of Towns [distance myself]) * 8.1; calcule la distance en patches jusqu'à la ville la plus proche (nombre de patche * 8.1 km)
    set Distance_cost Distance_to_towns * Surplus * 1000 * Transport_costs
    set Surplus_Price Surplus * 1000 / 6.7 * Wheat_price - Distance_cost ; (1 modius = 8.67l = 6.7 kg)
    ;set size 0.5
    set size Surplus_Price / 100000
    if any? Towns-on patch-here [set hidden? true];la ferme est cachée s'il existe une ville sur le patch (pour une meilleure lisibilité de la carte)
    ask Farms [if harvest < people * 0.3 [die]]
  ]
end

to setup-Farms-I
  ask patches [if WR > 0 [sprout-Farms 1]]
  ask Farms [
    set shape "House"
    set color white
    set size 0.5
    set cultivated-area Cultivated_area; ces fermes peuvent cultiver jusqu'à 10 ha maximum
    set harvest cultivated-area * WI; récolte égale à la superficie cultivée * rendement en blé pluvial (WR)
    set people 6
  ]
end

;to-report Surplus_
  ;report sum [Surplus] of Farms
;end

 to setup-Towns
  ask patches gis:intersecting Capitales [
    sprout-Towns 1
  ]
  ask Towns [
    set shape "House"
    ;set size 0.5
    set color red
    ;set Feed_people sum [Surplus] of Farms
    ;set Feed_people [Surplus] of Farms
    set local_carrying_capacity sum [Surplus] of Farms in-radius 4 / 0.2; calcule la somme des surplus des fermes dans un rayon de 3 patches puis divise par 0.2 (0.2 tonnes, soit 200kg, soit la ration annuelle de blé pour une personne)
    set size local_carrying_capacity / 500
    set size 1
    ;set label "Ville"
  ]
end

to setup-Wineries-I
  ask patches [if GI > 0 [sprout-Wineries 1]]
  ask Wineries [if any? Towns-on patch-here [die]]; l'établissement viticole meurt si il existe une ville sur le patche
    ask Wineries [
    set shape "house"
    set color white
    ;set size 0.5
    set area_exploited 25; les domaines viticoles exploitent 25 ha soit 100 jugères
    set production GI * area_exploited ; production en HL = rendement * surface cultivée
    ;set Price_production production * 1600 ; prix total de la production à raison de 1600 deniers/sesterces par hectolitres
    set Price_production production / 5.233 * 300 ;production recalculée en culleus (5.233 hl) et multipliée par 300 sesterces (prix minimum du vin dans Columelle)
    set Distance_to_towns distance (min-one-of Towns [distance myself]) * 8.1; calcule la distance en patches jusqu'à la ville la plus proche (nombre de patches * 8.1 km)
    set Distance_cost Distance_to_towns * production / 392.4 * 13.5; coûts de transport par hectolitre en sesterces (d'après l'édit de Dioclétien, 20 deniers par mille (1.472 km, soit 13.5 deniers/km) pour 1 chariot de 1200 livres (392.4 kg)
    set Number_of_Slaves area_exploited * 4 / 7; 7 esclaves/jugère d'après Columelle
    set Slaves_cost Number_of_Slaves * 140; d'après Etienne 1980, le prix d'entretien annuel d'un esclave est de 140 HS (sesterces)
    set Benefit Price_production - Distance_cost - Slaves_cost ; bénéfice égal au prix de la production moins les coûts de transport
    set size Benefit / 100000
  ]
end

to setup-Wineries-R
  ask patches [if GR > 0 [sprout-Wineries 1]]
  ask Wineries [if any? Towns-on patch-here [die]]; l'établissement viticole meurt si il existe une ville sur le patche
    ask Wineries [
    set shape "house"
    set color white
    ;set size 0.5
    set area_exploited 25; les domaines viticoles exploitent 25 ha soit 100 jugères
    set production GR * area_exploited ; production en HL = rendement * surface cultivée
    ;set Price_production production * 1600 ; prix total de la production à raison de 1600 deniers/sesterces par hectolitres
    set Price_production production / 5.233 * 300 ;production recalculée en culleus (5.233 hl) et multipliée par 300 sesterces (prix minimum du vin dans Columelle)
    set Distance_to_towns distance (min-one-of Towns [distance myself]) * 8.1; calcule la distance en patches jusqu'à la ville la plus proche (nombre de patche * 8.1 km)
    set Distance_cost Distance_to_towns * production * Transport_costs; coûts de transport par hectolitre en sesterces (d'après l'édit de Dioclétien, 20 deniers par mille (1.472 km, soit 13.5 deniers/km) pour 1 chariot de 1200 livres (392.4 kg)
    set Number_of_Slaves area_exploited * 4 / 7; 7 esclaves/jugère d'après Columelle
    set Slaves_cost Number_of_Slaves * 140; d'après Etienne 1980, le prix d'entretien annuel d'un esclave est de 140 HS (sesterces)
    set Benefit Price_production - Distance_cost - Slaves_cost ; bénéfice égal au prix de la production moins les coûts de transport
    ;set size Benefit / 10000
  ]
end

to setup-Wineries-R2
  ;ask patches [if GR > 0 [sprout-Wineries 1]]
  ask patches gis:intersecting Narbonnaise [sprout-Wineries 1]
    ask Wineries [
    if any? Towns-on patch-here [set hidden? true]; cache l'agent s'il existe une ville dans le patche
    ;fd 0.1
    set shape "Square"
    set color violet
    set size 0.7
    set area_exploited 25; les domaines viticoles exploitent 25 ha soit 100 jugères
    set production GR * area_exploited ; production en HL = rendement * surface cultivée
    ;set Price_production production / 5.233 * 300 ;production recalculée en culleus (1 culléus = 5.233 hl) et multipliée par 300 sesterces (prix minimum du culléus de vin d'après Columelle III,3)
    set Price_production production * 100 * Wine_price * 4 * 2 ; production HL convertie en L (*100)
    set Distance_to_towns distance (min-one-of Towns [distance myself]) * 8.1; calcule en km la distance jusqu'à la ville la plus proche (-> nombre de patches * 8.1 km)
    set Distance_cost Distance_to_towns * production * 100 * Transport_costs; coûts de transport par hectolitre en sesterces (d'après l'édit de Dioclétien, 20 deniers par mille (1 mille = 1.472 km -> 13.5 deniers/km) pour 1 chariot de 1200 livres (-> 392.4 kg)
    set Number_of_Slaves area_exploited * 4 / 7; 7 esclaves/jugère d'après Columelle
    set Slaves_cost Number_of_Slaves * 140; d'après Etienne 1980, le prix d'entretien annuel d'un esclave est de 140 HS (sesterces)
    set Benefit Price_production - Distance_cost - Slaves_cost ; bénéfice égal au prix de la production moins les coûts de transport
    set size Benefit / 1000000
    ;set size Benefit / 10000000
  ]
end

  to setup-Olives_groves-R
  ;ask patches [if OR_ > 0 [sprout-Olives_groves 1]]
  ;ask patches gis:intersecting Limite_olivier [sprout-Olives_groves 1]
  ask patches gis:intersecting Narbonnaise [sprout-Olives_groves 1]
    ask Olives_groves [
    if any? Towns-on patch-here [set hidden? true]
    ;fd 0.1
    set shape "square"
    set color green
    ;set size 0.5
    set area_exploited 25
    set production OR_ * area_exploited / 5; production d'olives en T = rendement * surface cultivée puis conversion en litre d'huile sur la base de 5kg d'olives pour 1 litre d'huile
    set Price_production production * 1000 * Oil_price * 4 * 2; production en T convertie en kg (* 1000) * 32 (d'après l'édit de Dioclétien 8 deniers le sextarius d'huile d'olive OLEI RAPHANINI = 16 deniers/l = 64 sesterces/l)
    set Distance_to_towns distance (min-one-of Towns [distance myself]) * 8.1; distance de l'exploitation jusqu'à la ville la plus proche (nombre de patche * 8.1 km)
    set Distance_cost Distance_to_towns * production * 1000 * Transport_costs; coûts de transport en sesterces (d'après l'édit de Dioclétien, 20 deniers par mille (1.472 km, soit 13.5 deniers/km) pour 1 chariot de 1200 livres (392.4 kg)
    set Number_of_Slaves area_exploited / 4.6; 13 esclaves pour 240 jugères dans l'olivette de Caton
    set Slaves_cost Number_of_Slaves * 140; d'après Etienne 1980, le prix d'entretien annuel d'un esclave est de 140 HS (sesterces)
    set Benefit Price_production - Slaves_cost - Distance_cost ; bénéfice égal au prix de la production moins le coût du personne et du transport
    set size Benefit / 1000000 * 5
    ;set size log 10000 Benefit
  ]
end

  to setup-Olives_groves-I; olives irriguées
  ;ask patches [if OR_ > 0 [sprout-Olives_groves 1]]
  ;ask patches gis:intersecting Limite_olivier [sprout-Olives_groves 1]
  ask patches gis:intersecting Narbonnaise [sprout-Olives_groves 1]
    ask Olives_groves [
    if any? Towns-on patch-here [set hidden? true]
    ;fd 0.1
    set shape "square"
    set color green
    ;set size 0.5
    set area_exploited 60; les olivettes exploitent 60 ha = 240 jugères (modèle de l'olivette de Caton)
    set production OI * area_exploited / 5; production d'olives en T = rendement * surface cultivée puis conversion en litre d'huile sur la base de 5kg d'olives pour 1 litre d'huile
    set Price_production production * 1000 * Oil_price * 4 * 2; production en T convertie en kg (* 1000) * Oil_price (globals) * 4 (conversion des deniers en sesterces) * 2 (conversion du sextarius en litres)
    set Distance_to_towns distance (min-one-of Towns [distance myself]) * 8.1; distance de l'exploitation jusqu'à la ville la plus proche (nombre de patche * 8.1 km)
    set Distance_cost Distance_to_towns * production * 1000 * Transport_costs; coûts de transport en sesterces (d'après l'édit de Dioclétien, 20 deniers par mille (1.472 km, soit 13.5 deniers/km) pour 1 chariot de 1200 livres (392.4 kg)
    set Number_of_Slaves 13; 13 personnes dans l'olivette de Caton
    set Slaves_cost Number_of_Slaves * 140; d'après Etienne 1980, le prix d'entretien annuel d'un esclave est de 140 HS (sesterces)
    set Benefit Price_production - Slaves_cost - Distance_cost ; bénéfice égal au prix de la production moins le coût du personne et du transport
    ;set size Benefit / 300000000
    set size log 100000 Benefit
    ;set size 1
  ]
end

;to display-Dioceses
  ;gis:set-drawing-color black
  ;gis:draw Dioceses 1
;end

to display-Archeo-Olives
  ;gis:set-drawing-color black
  ;gis:draw Archeo_Olive 2
end

to display-Archeo-Wine
  ;gis:set-drawing-color red
  ;gis:draw Archaeo_Wine 2
end

to import-climatic-data
  import-2500BP-climatic-data
  import-2400BP-climatic-data
  import-2300BP-climatic-data
  import-2200BP-climatic-data
  import-2100BP-climatic-data
  import-2000BP-climatic-data
  import-1900BP-climatic-data
  import-1800BP-climatic-data
  import-1700BP-climatic-data
  import-1600BP-climatic-data
  import-1500BP-climatic-data
  import-1400BP-climatic-data
  import-1300BP-climatic-data
  import-REF-climatic-data
end

to apply-climatic-data
  apply-2500BP-climatic-data
  apply-2400BP-climatic-data
  apply-2300BP-climatic-data
  apply-2200BP-climatic-data
  apply-2100BP-climatic-data
  apply-2000BP-climatic-data
  apply-1900BP-climatic-data
  apply-1800BP-climatic-data
  apply-1700BP-climatic-data
  apply-1600BP-climatic-data
  apply-1500BP-climatic-data
  apply-1400BP-climatic-data
  apply-1300BP-climatic-data
  apply-REF-climatic-data
end

to compute-climatic-data
  if Century = "2500 BP" [compute-climatic-data-2500BP]
  if Century = "2400 BP" [compute-climatic-data-2400BP]
  if Century = "2300 BP" [compute-climatic-data-2300BP]
  if Century = "2200 BP" [compute-climatic-data-2200BP]
  if Century = "2100 BP" [compute-climatic-data-2100BP]
  if Century = "2000 BP" [compute-climatic-data-2000BP]
  if Century = "1900 BP" [compute-climatic-data-1900BP]
  if Century = "1800 BP" [compute-climatic-data-1800BP]
  if Century = "1700 BP" [compute-climatic-data-1700BP]
  if Century = "1600 BP" [compute-climatic-data-1600BP]
  if Century = "1500 BP" [compute-climatic-data-1500BP]
  if Century = "1400 BP" [compute-climatic-data-1400BP]
  if Century = "1300 BP" [compute-climatic-data-1700BP]

  if Century = "Actual" [compute-climatic-data-REF]
end
@#$#@#$#@
GRAPHICS-WINDOW
154
10
1020
461
-1
-1
13.0
1
10
1
1
1
0
0
0
1
0
65
0
33
1
1
1
ticks
30.0

BUTTON
6
10
69
43
NIL
setup
NIL
1
T
OBSERVER
NIL
NIL
NIL
NIL
1

SLIDER
1044
10
1216
43
Thiv_ano
Thiv_ano
-2
2
0.0
0.1
1
°C
HORIZONTAL

BUTTON
77
10
140
43
NIL
go
NIL
1
T
OBSERVER
NIL
NIL
NIL
NIL
1

PLOT
1030
182
1230
332
max of yields
NIL
NIL
0.0
10.0
0.0
10.0
false
true
"" ""
PENS
"Wheat R" 1.0 0 -1184463 true "" "if ticks != 0 [plot max [WR] of patches]"
"Grapes R" 1.0 0 -5825686 true "" "if ticks != 0 [plot max [GR] of patches / 20]"
"Olive R" 1.0 0 -13840069 true "" "if ticks != 0 [plot max [OR_] of patches]"

SLIDER
1045
52
1217
85
Tprt_ano
Tprt_ano
-2
2
0.0
0.1
1
°C
HORIZONTAL

SLIDER
1044
96
1216
129
Tete_ano
Tete_ano
-2
2
0.0
0.1
1
°C
HORIZONTAL

SLIDER
1045
138
1217
171
Taut_ano
Taut_ano
-2
2
0.0
0.1
1
°C
HORIZONTAL

SLIDER
1230
10
1402
43
Phiv_ano
Phiv_ano
-50
50
0.0
1
1
mm
HORIZONTAL

SLIDER
1232
54
1404
87
Pprt_ano
Pprt_ano
-50
50
0.0
1
1
mm
HORIZONTAL

SLIDER
1233
95
1405
128
Pete_ano
Pete_ano
-50
50
0.0
1
1
mm
HORIZONTAL

SLIDER
1234
137
1406
170
Paut_ano
Paut_ano
-50
50
0.0
1
1
mm
HORIZONTAL

CHOOSER
5
55
143
100
Culture
Culture
"None" "Wheat rainfed" "Wheat irrigated" "Grapes rainfed" "Grapes irrigated" "Olives rainfed" "Olives irrigated" "Peas rainfed" "Peas irrigated"
0

CHOOSER
6
115
144
160
Century
Century
"Actual" "2500 BP" "2400 BP" "2300 BP" "2200 BP" "2100 BP" "2000 BP" "1900 BP" "1800 BP" "1700 BP" "1600 BP" "1500 BP" "1400 BP" "1300 BP"
13

SLIDER
849
467
1021
500
Cultivated_area
Cultivated_area
0
6
2.8
0.05
1
ha
HORIZONTAL

PLOT
1031
346
1231
496
N of exploitations
NIL
NIL
0.0
10.0
0.0
10.0
true
true
"" ""
PENS
"Wineries" 1.0 0 -10141563 true "" "if ticks != 0 [plot count Wineries]"
"Farms" 1.0 0 -1184463 true "" "if ticks != 0 [plot count Farms]"
"Olives groves" 1.0 0 -11085214 true "" "if ticks != 0 [plot count Olives_groves]"

SLIDER
1246
386
1452
419
Transport_costs
Transport_costs
0
2
0.075
0.005
1
HS/km/kg
HORIZONTAL

TEXTBOX
478
182
507
200
Nîmes
11
0.0
0

TEXTBOX
861
229
894
247
Fréjus
11
0.0
0

TEXTBOX
952
239
991
257
Antibes
11
0.0
0

TEXTBOX
342
259
378
277
Béziers
11
0.0
0

TEXTBOX
250
285
300
303
Narbonne
11
0.0
0

TEXTBOX
171
311
236
329
Carcassonne
11
0.0
0

TEXTBOX
678
218
696
236
Aix
11
0.0
0

TEXTBOX
520
210
546
228
Arles
11
0.0
0

TEXTBOX
677
271
733
289
  Marseille
11
0.0
0

SWITCH
155
468
325
501
Dis-archeo-olives?
Dis-archeo-olives?
1
1
-1000

SWITCH
330
469
480
502
Dis-archeo-wine?
Dis-archeo-wine?
1
1
-1000

TEXTBOX
300
209
338
227
Lodève
11
0.0
0

TEXTBOX
1254
425
1424
443
0.2HS/km/kg (édit de Dioclétien)
11
0.0
1

SLIDER
1239
181
1437
214
Oil_price
Oil_price
0
40
6.0
1
1
deniers/sextarius
HORIZONTAL

TEXTBOX
1244
220
1394
248
Olei raphanini = 8\nOlei floris = 40
11
0.0
1

SLIDER
1243
252
1448
285
Wine_price
Wine_price
0
30
6.0
1
1
deniers/sextarius
HORIZONTAL

TEXTBOX
1246
290
1396
318
Vini rustici = 8\nPiceni = 30
11
0.0
1

SLIDER
1244
323
1450
356
Wheat_price
Wheat_price
0
100
20.0
1
1
deniers/modius
HORIZONTAL

TEXTBOX
1250
363
1400
381
Wheat = 100 deniers/modius
11
0.0
1

PLOT
1249
445
1449
595
Pot. benefits
Centuries
NIL
0.0
14.0
0.0
10.0
true
true
"" ""
PENS
"Wineries" 1.0 0 -10141563 true "" "if ticks != 0 [plot sum [Benefit] of Wineries / 1000000]"
"Olives groves" 1.0 0 -11085214 true "" "if ticks != 0 [plot sum [Benefit] of Olives_groves / 1000000]"
"Wheat farms" 1.0 0 -987046 true "" "if ticks != 0 [plot sum [Surplus_Price] of Farms / 1000000]"

TEXTBOX
259
385
308
403
Perpignan
11
0.0
0

TEXTBOX
779
210
809
230
Riez
11
0.0
0

TEXTBOX
682
38
702
56
Die
11
0.0
0

TEXTBOX
516
142
545
160
Uzès
11
0.0
0

TEXTBOX
662
163
685
181
Apt
11
0.0
0

TEXTBOX
708
131
752
149
Sisteron
11
0.0
0

TEXTBOX
765
63
789
81
Gap
11
0.0
0

TEXTBOX
696
67
716
85
Luc
11
0.0
0

TEXTBOX
810
131
840
149
Digne
11
0.0
0

TEXTBOX
524
66
551
84
Alba
11
0.0
0

TEXTBOX
533
18
574
36
Valence
11
0.0
0

TEXTBOX
582
214
624
232
Glanum
11
0.0
0

TEXTBOX
552
126
592
144
Orange
11
0.0
0

TEXTBOX
586
89
626
107
St-Paul
11
0.0
0

TEXTBOX
629
125
661
143
Vaison
11
0.0
0

TEXTBOX
630
146
689
164
Carpentras
11
0.0
0

TEXTBOX
622
198
666
216
Cavaillon
11
0.0
0

TEXTBOX
531
183
575
201
Avignon
11
0.0
0

@#$#@#$#@
## WHAT IS IT?

(a general understanding of what the model is trying to show or explain)

## HOW IT WORKS

(what rules the agents use to create the overall behavior of the model)

## HOW TO USE IT

(how to use the model, including a description of each of the items in the Interface tab)

## THINGS TO NOTICE

(suggested things for the user to notice while running the model)

## THINGS TO TRY

(suggested things for the user to try to do (move sliders, switches, etc.) with the model)

## EXTENDING THE MODEL

(suggested things to add or change in the Code tab to make the model more complicated, detailed, accurate, etc.)

## NETLOGO FEATURES

(interesting or unusual features of NetLogo that the model uses, particularly in the Code tab; or where workarounds were needed for missing features)

## RELATED MODELS

(models in the NetLogo Models Library and elsewhere which are of related interest)

## CREDITS AND REFERENCES

(a reference to the model's URL on the web if it has one, as well as any other necessary credits, citations, and links)
@#$#@#$#@
default
true
0
Polygon -7500403 true true 150 5 40 250 150 205 260 250

airplane
true
0
Polygon -7500403 true true 150 0 135 15 120 60 120 105 15 165 15 195 120 180 135 240 105 270 120 285 150 270 180 285 210 270 165 240 180 180 285 195 285 165 180 105 180 60 165 15

arrow
true
0
Polygon -7500403 true true 150 0 0 150 105 150 105 293 195 293 195 150 300 150

berni_square
true
0
Rectangle -8630108 false false 45 45 255 255
Rectangle -8630108 true false 45 45 255 255

box
false
0
Polygon -7500403 true true 150 285 285 225 285 75 150 135
Polygon -7500403 true true 150 135 15 75 150 15 285 75
Polygon -7500403 true true 15 75 15 225 150 285 150 135
Line -16777216 false 150 285 150 135
Line -16777216 false 150 135 15 75
Line -16777216 false 150 135 285 75

bug
true
0
Circle -7500403 true true 96 182 108
Circle -7500403 true true 110 127 80
Circle -7500403 true true 110 75 80
Line -7500403 true 150 100 80 30
Line -7500403 true 150 100 220 30

butterfly
true
0
Polygon -7500403 true true 150 165 209 199 225 225 225 255 195 270 165 255 150 240
Polygon -7500403 true true 150 165 89 198 75 225 75 255 105 270 135 255 150 240
Polygon -7500403 true true 139 148 100 105 55 90 25 90 10 105 10 135 25 180 40 195 85 194 139 163
Polygon -7500403 true true 162 150 200 105 245 90 275 90 290 105 290 135 275 180 260 195 215 195 162 165
Polygon -16777216 true false 150 255 135 225 120 150 135 120 150 105 165 120 180 150 165 225
Circle -16777216 true false 135 90 30
Line -16777216 false 150 105 195 60
Line -16777216 false 150 105 105 60

car
false
0
Polygon -7500403 true true 300 180 279 164 261 144 240 135 226 132 213 106 203 84 185 63 159 50 135 50 75 60 0 150 0 165 0 225 300 225 300 180
Circle -16777216 true false 180 180 90
Circle -16777216 true false 30 180 90
Polygon -16777216 true false 162 80 132 78 134 135 209 135 194 105 189 96 180 89
Circle -7500403 true true 47 195 58
Circle -7500403 true true 195 195 58

circle
false
0
Circle -7500403 true true 0 0 300

circle 2
false
0
Circle -7500403 true true 0 0 300
Circle -16777216 true false 30 30 240

cow
false
0
Polygon -7500403 true true 200 193 197 249 179 249 177 196 166 187 140 189 93 191 78 179 72 211 49 209 48 181 37 149 25 120 25 89 45 72 103 84 179 75 198 76 252 64 272 81 293 103 285 121 255 121 242 118 224 167
Polygon -7500403 true true 73 210 86 251 62 249 48 208
Polygon -7500403 true true 25 114 16 195 9 204 23 213 25 200 39 123

cylinder
false
0
Circle -7500403 true true 0 0 300

dot
false
0
Circle -7500403 true true 90 90 120

face happy
false
0
Circle -7500403 true true 8 8 285
Circle -16777216 true false 60 75 60
Circle -16777216 true false 180 75 60
Polygon -16777216 true false 150 255 90 239 62 213 47 191 67 179 90 203 109 218 150 225 192 218 210 203 227 181 251 194 236 217 212 240

face neutral
false
0
Circle -7500403 true true 8 7 285
Circle -16777216 true false 60 75 60
Circle -16777216 true false 180 75 60
Rectangle -16777216 true false 60 195 240 225

face sad
false
0
Circle -7500403 true true 8 8 285
Circle -16777216 true false 60 75 60
Circle -16777216 true false 180 75 60
Polygon -16777216 true false 150 168 90 184 62 210 47 232 67 244 90 220 109 205 150 198 192 205 210 220 227 242 251 229 236 206 212 183

fish
false
0
Polygon -1 true false 44 131 21 87 15 86 0 120 15 150 0 180 13 214 20 212 45 166
Polygon -1 true false 135 195 119 235 95 218 76 210 46 204 60 165
Polygon -1 true false 75 45 83 77 71 103 86 114 166 78 135 60
Polygon -7500403 true true 30 136 151 77 226 81 280 119 292 146 292 160 287 170 270 195 195 210 151 212 30 166
Circle -16777216 true false 215 106 30

flag
false
0
Rectangle -7500403 true true 60 15 75 300
Polygon -7500403 true true 90 150 270 90 90 30
Line -7500403 true 75 135 90 135
Line -7500403 true 75 45 90 45

flower
false
0
Polygon -10899396 true false 135 120 165 165 180 210 180 240 150 300 165 300 195 240 195 195 165 135
Circle -7500403 true true 85 132 38
Circle -7500403 true true 130 147 38
Circle -7500403 true true 192 85 38
Circle -7500403 true true 85 40 38
Circle -7500403 true true 177 40 38
Circle -7500403 true true 177 132 38
Circle -7500403 true true 70 85 38
Circle -7500403 true true 130 25 38
Circle -7500403 true true 96 51 108
Circle -16777216 true false 113 68 74
Polygon -10899396 true false 189 233 219 188 249 173 279 188 234 218
Polygon -10899396 true false 180 255 150 210 105 210 75 240 135 240

house
false
0
Rectangle -7500403 true true 45 120 255 285
Rectangle -16777216 true false 120 210 180 285
Polygon -7500403 true true 15 120 150 15 285 120
Line -16777216 false 30 120 270 120

leaf
false
0
Polygon -7500403 true true 150 210 135 195 120 210 60 210 30 195 60 180 60 165 15 135 30 120 15 105 40 104 45 90 60 90 90 105 105 120 120 120 105 60 120 60 135 30 150 15 165 30 180 60 195 60 180 120 195 120 210 105 240 90 255 90 263 104 285 105 270 120 285 135 240 165 240 180 270 195 240 210 180 210 165 195
Polygon -7500403 true true 135 195 135 240 120 255 105 255 105 285 135 285 165 240 165 195

line
true
0
Line -7500403 true 150 0 150 300

line half
true
0
Line -7500403 true 150 0 150 150

pentagon
false
0
Polygon -7500403 true true 150 15 15 120 60 285 240 285 285 120

person
false
0
Circle -7500403 true true 110 5 80
Polygon -7500403 true true 105 90 120 195 90 285 105 300 135 300 150 225 165 300 195 300 210 285 180 195 195 90
Rectangle -7500403 true true 127 79 172 94
Polygon -7500403 true true 195 90 240 150 225 180 165 105
Polygon -7500403 true true 105 90 60 150 75 180 135 105

plant
false
0
Rectangle -7500403 true true 135 90 165 300
Polygon -7500403 true true 135 255 90 210 45 195 75 255 135 285
Polygon -7500403 true true 165 255 210 210 255 195 225 255 165 285
Polygon -7500403 true true 135 180 90 135 45 120 75 180 135 210
Polygon -7500403 true true 165 180 165 210 225 180 255 120 210 135
Polygon -7500403 true true 135 105 90 60 45 45 75 105 135 135
Polygon -7500403 true true 165 105 165 135 225 105 255 45 210 60
Polygon -7500403 true true 135 90 120 45 150 15 180 45 165 90

sheep
false
15
Circle -1 true true 203 65 88
Circle -1 true true 70 65 162
Circle -1 true true 150 105 120
Polygon -7500403 true false 218 120 240 165 255 165 278 120
Circle -7500403 true false 214 72 67
Rectangle -1 true true 164 223 179 298
Polygon -1 true true 45 285 30 285 30 240 15 195 45 210
Circle -1 true true 3 83 150
Rectangle -1 true true 65 221 80 296
Polygon -1 true true 195 285 210 285 210 240 240 210 195 210
Polygon -7500403 true false 276 85 285 105 302 99 294 83
Polygon -7500403 true false 219 85 210 105 193 99 201 83

square
false
0
Rectangle -7500403 true true 30 30 270 270

square 2
false
0
Rectangle -7500403 true true 30 30 270 270
Rectangle -16777216 true false 60 60 240 240

star
false
0
Polygon -7500403 true true 151 1 185 108 298 108 207 175 242 282 151 216 59 282 94 175 3 108 116 108

target
false
0
Circle -7500403 true true 0 0 300
Circle -16777216 true false 30 30 240
Circle -7500403 true true 60 60 180
Circle -16777216 true false 90 90 120
Circle -7500403 true true 120 120 60

tree
false
0
Circle -7500403 true true 118 3 94
Rectangle -6459832 true false 120 195 180 300
Circle -7500403 true true 65 21 108
Circle -7500403 true true 116 41 127
Circle -7500403 true true 45 90 120
Circle -7500403 true true 104 74 152

triangle
false
0
Polygon -7500403 true true 150 30 15 255 285 255

triangle 2
false
0
Polygon -7500403 true true 150 30 15 255 285 255
Polygon -16777216 true false 151 99 225 223 75 224

truck
false
0
Rectangle -7500403 true true 4 45 195 187
Polygon -7500403 true true 296 193 296 150 259 134 244 104 208 104 207 194
Rectangle -1 true false 195 60 195 105
Polygon -16777216 true false 238 112 252 141 219 141 218 112
Circle -16777216 true false 234 174 42
Rectangle -7500403 true true 181 185 214 194
Circle -16777216 true false 144 174 42
Circle -16777216 true false 24 174 42
Circle -7500403 false true 24 174 42
Circle -7500403 false true 144 174 42
Circle -7500403 false true 234 174 42

turtle
true
0
Polygon -10899396 true false 215 204 240 233 246 254 228 266 215 252 193 210
Polygon -10899396 true false 195 90 225 75 245 75 260 89 269 108 261 124 240 105 225 105 210 105
Polygon -10899396 true false 105 90 75 75 55 75 40 89 31 108 39 124 60 105 75 105 90 105
Polygon -10899396 true false 132 85 134 64 107 51 108 17 150 2 192 18 192 52 169 65 172 87
Polygon -10899396 true false 85 204 60 233 54 254 72 266 85 252 107 210
Polygon -7500403 true true 119 75 179 75 209 101 224 135 220 225 175 261 128 261 81 224 74 135 88 99

wheel
false
0
Circle -7500403 true true 3 3 294
Circle -16777216 true false 30 30 240
Line -7500403 true 150 285 150 15
Line -7500403 true 15 150 285 150
Circle -7500403 true true 120 120 60
Line -7500403 true 216 40 79 269
Line -7500403 true 40 84 269 221
Line -7500403 true 40 216 269 79
Line -7500403 true 84 40 221 269

wolf
false
0
Polygon -16777216 true false 253 133 245 131 245 133
Polygon -7500403 true true 2 194 13 197 30 191 38 193 38 205 20 226 20 257 27 265 38 266 40 260 31 253 31 230 60 206 68 198 75 209 66 228 65 243 82 261 84 268 100 267 103 261 77 239 79 231 100 207 98 196 119 201 143 202 160 195 166 210 172 213 173 238 167 251 160 248 154 265 169 264 178 247 186 240 198 260 200 271 217 271 219 262 207 258 195 230 192 198 210 184 227 164 242 144 259 145 284 151 277 141 293 140 299 134 297 127 273 119 270 105
Polygon -7500403 true true -1 195 14 180 36 166 40 153 53 140 82 131 134 133 159 126 188 115 227 108 236 102 238 98 268 86 269 92 281 87 269 103 269 113

x
false
0
Polygon -7500403 true true 270 75 225 30 30 225 75 270
Polygon -7500403 true true 30 75 75 30 270 225 225 270
@#$#@#$#@
NetLogo 6.0.4
@#$#@#$#@
@#$#@#$#@
@#$#@#$#@
@#$#@#$#@
@#$#@#$#@
default
0.0
-0.2 0 0.0 1.0
0.0 1 1.0 0.0
0.2 0 0.0 1.0
link direction
true
0
Line -7500403 true 150 150 90 180
Line -7500403 true 150 150 210 180
@#$#@#$#@
0
@#$#@#$#@
